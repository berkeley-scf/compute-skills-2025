<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.31">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Version control, programming, and testing</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-e1a5c8363afafaef2c763b6775fbf3ca.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-a9ac95982dfa497af26296eb1ce0c91d.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../assets/styles.css">
<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar docked quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../units/comp-practices.html">Modules</a></li><li class="breadcrumb-item"><a href="../units/comp-practices.html">Computational Tools and Practices</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="../index.html" class="sidebar-logo-link">
      <img src="../assets/stat_bear.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Computational Skills Workshop</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/berkeley-scf/compute-skills-2025" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home / Schedule</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../syllabus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Overview</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../prep.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Computational Environment</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Modules</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../units/comp-practices.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Computational Tools and Practices</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../units/additional-topics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Numerics and Reproducibility</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../units/intro-computing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Intro to Computing and Command Line (optional)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../units/intro-python.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Intro to Python (optional)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../units/mini-project.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Python Mini Project (optional)</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../license.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">License</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#our-running-example-newtons-method-for-optimization" id="toc-our-running-example-newtons-method-for-optimization" class="nav-link active" data-scroll-target="#our-running-example-newtons-method-for-optimization">1. Our running example: Newton’s method for optimization</a>
  <ul class="collapse">
  <li><a href="#newtons-method-background" id="toc-newtons-method-background" class="nav-link" data-scroll-target="#newtons-method-background">Newton’s method background</a></li>
  <li><a href="#exercise-implement-univariate-newtons-method" id="toc-exercise-implement-univariate-newtons-method" class="nav-link" data-scroll-target="#exercise-implement-univariate-newtons-method">Exercise: Implement univariate Newton’s method</a></li>
  </ul></li>
  <li><a href="#introduction-to-git-and-github" id="toc-introduction-to-git-and-github" class="nav-link" data-scroll-target="#introduction-to-git-and-github">2. Introduction to Git and GitHub</a>
  <ul class="collapse">
  <li><a href="#exercise-creating-a-git-repository-on-github" id="toc-exercise-creating-a-git-repository-on-github" class="nav-link" data-scroll-target="#exercise-creating-a-git-repository-on-github">Exercise: Creating a Git repository (on GitHub)</a></li>
  <li><a href="#exercise-accessing-github-repositories-from-datahub" id="toc-exercise-accessing-github-repositories-from-datahub" class="nav-link" data-scroll-target="#exercise-accessing-github-repositories-from-datahub">Exercise: Accessing GitHub repositories from DataHub</a></li>
  <li><a href="#basic-use-of-a-repository" id="toc-basic-use-of-a-repository" class="nav-link" data-scroll-target="#basic-use-of-a-repository">Basic use of a repository</a>
  <ul class="collapse">
  <li><a href="#writing-good-commit-messages" id="toc-writing-good-commit-messages" class="nav-link" data-scroll-target="#writing-good-commit-messages">Writing good commit messages</a></li>
  </ul></li>
  <li><a href="#exercise-put-your-code-in-your-repository" id="toc-exercise-put-your-code-in-your-repository" class="nav-link" data-scroll-target="#exercise-put-your-code-in-your-repository">Exercise: Put your code in your repository</a></li>
  </ul></li>
  <li><a href="#understanding-git" id="toc-understanding-git" class="nav-link" data-scroll-target="#understanding-git">3. Understanding Git</a>
  <ul class="collapse">
  <li><a href="#git-visuals-understanding-git-concepts" id="toc-git-visuals-understanding-git-concepts" class="nav-link" data-scroll-target="#git-visuals-understanding-git-concepts">Git visuals: Understanding Git concepts</a></li>
  <li><a href="#key-components-and-terminology" id="toc-key-components-and-terminology" class="nav-link" data-scroll-target="#key-components-and-terminology">Key components and terminology</a>
  <ul class="collapse">
  <li><a href="#commits" id="toc-commits" class="nav-link" data-scroll-target="#commits">Commits</a></li>
  <li><a href="#a-repository" id="toc-a-repository" class="nav-link" data-scroll-target="#a-repository">A repository</a></li>
  <li><a href="#staging-area-index" id="toc-staging-area-index" class="nav-link" data-scroll-target="#staging-area-index">Staging area / index</a></li>
  </ul></li>
  <li><a href="#exercise-code-review-with-a-partner" id="toc-exercise-code-review-with-a-partner" class="nav-link" data-scroll-target="#exercise-code-review-with-a-partner">Exercise: code review (with a partner)</a></li>
  </ul></li>
  <li><a href="#code-style-and-documentation" id="toc-code-style-and-documentation" class="nav-link" data-scroll-target="#code-style-and-documentation">4. Code style and documentation</a>
  <ul class="collapse">
  <li><a href="#linting" id="toc-linting" class="nav-link" data-scroll-target="#linting">Linting</a></li>
  <li><a href="#exercise-add-documentation-and-comments-to-your-newton-module" id="toc-exercise-add-documentation-and-comments-to-your-newton-module" class="nav-link" data-scroll-target="#exercise-add-documentation-and-comments-to-your-newton-module">Exercise: add documentation and comments to your Newton module</a></li>
  </ul></li>
  <li><a href="#debugging" id="toc-debugging" class="nav-link" data-scroll-target="#debugging">5. Debugging</a>
  <ul class="collapse">
  <li><a href="#demo-debugging-my-newton-implementation" id="toc-demo-debugging-my-newton-implementation" class="nav-link" data-scroll-target="#demo-debugging-my-newton-implementation">Demo: debugging my Newton implementation</a>
  <ul class="collapse">
  <li><a href="#using-the-jupyterlab-visual-debugger" id="toc-using-the-jupyterlab-visual-debugger" class="nav-link" data-scroll-target="#using-the-jupyterlab-visual-debugger">Using the JupyterLab visual debugger</a></li>
  <li><a href="#using-the-ipython-debugger-ipdb" id="toc-using-the-ipython-debugger-ipdb" class="nav-link" data-scroll-target="#using-the-ipython-debugger-ipdb">Using the IPython debugger (<code>ipdb</code>)</a></li>
  </ul></li>
  <li><a href="#exercise-debugging-your-newton-code" id="toc-exercise-debugging-your-newton-code" class="nav-link" data-scroll-target="#exercise-debugging-your-newton-code">Exercise: debugging your Newton code</a></li>
  </ul></li>
  <li><a href="#defensive-programming-error-checking-and-testing" id="toc-defensive-programming-error-checking-and-testing" class="nav-link" data-scroll-target="#defensive-programming-error-checking-and-testing">6. Defensive programming, error checking and testing</a>
  <ul class="collapse">
  <li><a href="#demo-unit-tests-and-pytest" id="toc-demo-unit-tests-and-pytest" class="nav-link" data-scroll-target="#demo-unit-tests-and-pytest">Demo: Unit tests and <code>pytest</code></a></li>
  <li><a href="#exercise-test-cases" id="toc-exercise-test-cases" class="nav-link" data-scroll-target="#exercise-test-cases">Exercise: Test cases</a></li>
  <li><a href="#exercise-unit-tests" id="toc-exercise-unit-tests" class="nav-link" data-scroll-target="#exercise-unit-tests">Exercise: Unit tests</a></li>
  <li><a href="#exceptions-in-python" id="toc-exceptions-in-python" class="nav-link" data-scroll-target="#exceptions-in-python">Exceptions in Python</a></li>
  <li><a href="#exercise-error-trapping-robust-code-and-defensive-programming" id="toc-exercise-error-trapping-robust-code-and-defensive-programming" class="nav-link" data-scroll-target="#exercise-error-trapping-robust-code-and-defensive-programming">Exercise: Error trapping, robust code, and defensive programming</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../units/comp-practices.html">Modules</a></li><li class="breadcrumb-item"><a href="../units/comp-practices.html">Computational Tools and Practices</a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Version control, programming, and testing</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Overview
</div>
</div>
<div class="callout-body-container callout-body">
<p>This module presents the core content of the workshop on version control (using Git), code style, documentation, and testing.</p>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled" title="Using AI assistance">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Using AI assistance
</div>
</div>
<div class="callout-body-container callout-body">
<p>I think it’s fair to say that most of us are still trying to understand how best to learn with the help of AI, without fooling ourselves into using AI without really learning/understanding.</p>
<p>You’re welcome to use an AI assistant (e.g., you can use GitHub Copilot for free with the GitHub Education program), but I strongly suggest you use it to assist and critique code you start to write on your own or ask it for tips rather than having it generate full code for you. That said, a regular internet search is likely to be just as effective for much of what we’ll be doing in the workshop.</p>
<p>If you have it generate entire blocks of code, you are unlikely to remember the syntax and ideas later, unlikely to understand well enough to debug/troubleshoot in the future, and likely to introduce errors from AI hallucinations.</p>
<p>When you do have AI generate code, particularly when learning or for important code, make sure you run, understand, and critique the result completely.</p>
<p>You may also want to look at <a href="https://swcarpentry.github.io/python-novice-inflammation/01-intro.html#generative-ai">this useful perspective from Software Carpentry about learning to code in the age of AI</a>.</p>
</div>
</div>
<section id="our-running-example-newtons-method-for-optimization" class="level1">
<h1>1. Our running example: Newton’s method for optimization</h1>
<section id="newtons-method-background" class="level2">
<h2 class="anchored" data-anchor-id="newtons-method-background">Newton’s method background</h2>
<p>We’ll use a running example, Newton’s method for optimization, during this workshop. It’s simple enough to be straightforward to code but can involve various modifications, extensions, etc. to be a rich enough example that we can use it to demonstrate various topics and tools.</p>
<p>Recall that Newton’s method works as follows to optimize some objective function, <span class="math inline">\(f(x)\)</span>, as a function of univariate or multivariate <span class="math inline">\(x\)</span>, where <span class="math inline">\(f(x)\)</span> is univariate.</p>
<p>Newton’s method is iterative. If we are at step <span class="math inline">\(t-1\)</span>, the next value (when minimizing a function of univariate <span class="math inline">\(x\)</span>) is:</p>
<p><span class="math display">\[
x_t = x_{t-1} - f^{\prime}(x_{t-1}) / f^{\prime\prime}(x_{t-1})
\]</span></p>
<p>Here are the steps:</p>
<ul>
<li>determine a starting value, <span class="math inline">\(x_0\)</span></li>
<li>iterate:
<ul>
<li>at step <span class="math inline">\(t\)</span>, the next value (the update) is given by the equation above</li>
<li>stop when <span class="math inline">\(\left\Vert x_{t} - x_{t-1} \right\Vert\)</span> is “small”</li>
</ul></li>
</ul>
<p>You can derive it by finding the root (aka zero) of the gradient function using a Taylor series approximation to the gradient.</p>
</section>
<section id="exercise-implement-univariate-newtons-method" class="level2">
<h2 class="anchored" data-anchor-id="exercise-implement-univariate-newtons-method">Exercise: Implement univariate Newton’s method</h2>
<p>Here’s what you’ll need your code to do:</p>
<ul>
<li>accept a starting value, <span class="math inline">\(x_0\)</span>, and the function, <span class="math inline">\(f(\cdot)\)</span>, to optimize</li>
<li>implement the iterative algorithm</li>
<li>implement the stopping criterion (feel free to keep this simple)</li>
<li>calculate the first and second derivatives using a basic finite difference approach to estimating the derivative based on the definition of a derivative as a limit
<ul>
<li>note that the second derivative can be seen as calling the first derivative twice…</li>
</ul></li>
<li>consider what to return as the output (feel free to keep it simple)</li>
<li>don’t worry much for now about making your code robust or dealing with tricky situations</li>
</ul>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Don’t make your finite difference (“epsilon”) too small or you’ll actually get inaccurate estimates. (We’ll discuss why when we talk a bit about <a href="additional-topics.html#calculation-errors">numerical issues in computing</a> later.)</p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>For now, please do not use any Python packages that provide finite difference-based derivatives. (We’ll do that later, and it’s helpful to have more code available for the work we’ll do today.)</p>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>You’re welcome to develop your code in a Jupyter Notebook, in the DataHub editor, in a separate editor on your laptop, or in VS Code on the DataHub (or your laptop).</p>
</div>
</div>
<p>Once you’ve written your Python functions, put your code into a simple text file, called <code>newton.py</code>. In doing so you’ve created a Python <em>module</em>.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Don’t use a Jupyter notebook (.ipynb) file at this stage, as it won’t work as a <em>module</em> and is not handled in git in the same nice manner as simple text files.</p>
</div>
</div>
<p>Once you have your module, you can use it like this:</p>
<div id="8401d1c8" class="cell" data-execution_count="1">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> newton</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>newton.optimize(start, fun)   <span class="co">## Assuming your function is called `optimize`.</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>newton.optimize(<span class="fl">2.5</span>, np.cos)  <span class="co">## Minimizing cos(x) from close-ish to one minimum.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>A <em>module</em> is a collection of related code in a file with the extension <code>.py</code>. The code can include functions, classes, and variables, as well as runnable code. To access the objects in the module, you need to import the module.</p>
</section>
</section>
<section id="introduction-to-git-and-github" class="level1">
<h1>2. Introduction to Git and GitHub</h1>
<section id="exercise-creating-a-git-repository-on-github" class="level2">
<h2 class="anchored" data-anchor-id="exercise-creating-a-git-repository-on-github">Exercise: Creating a Git repository (on GitHub)</h2>
<p>Go to <code>github.com/&lt;your_username&gt;</code> and click on the <code>Repositories</code> tag. Then click on the <code>New</code> button.</p>
<ul>
<li>In the form, give the repository the name <code>newton-practice</code> (so others who are working with you can find it easily)</li>
<li>Provide a short description</li>
<li>Click on “Add a README file”.</li>
<li>Leave the repository as “Public” so that others can interact with your repository when we practice later.</li>
<li>Scroll down to select <code>Python</code> under <code>Add .gitignore</code>.</li>
<li>Select a license (the BSD 3 Clause license is a good “permissive” one).</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Creating repositories on your laptop first
</div>
</div>
<div class="callout-body-container callout-body">
<p>It’s also possible to <a href="https://docs.github.com/en/migrations/importing-source-code/using-the-command-line-to-import-source-code/adding-locally-hosted-code-to-github#initializing-a-git-repository">create the repository from the terminal on your machine</a> and then link it to your GitHub account, but that’s a couple extra steps we won’t go into here at the moment.</p>
</div>
</div>
</section>
<section id="exercise-accessing-github-repositories-from-datahub" class="level2">
<h2 class="anchored" data-anchor-id="exercise-accessing-github-repositories-from-datahub">Exercise: Accessing GitHub repositories from DataHub</h2>
<p>Authenticating with GitHub can be a bit tricky, particularly when using DataHub (i.e., JupyterHub).</p>
<p>Please follow <a href="../prep.html#accessing-github-repositories-from-datahub">these instructions</a>.</p>
</section>
<section id="basic-use-of-a-repository" class="level2">
<h2 class="anchored" data-anchor-id="basic-use-of-a-repository">Basic use of a repository</h2>
<p>In the terminal, let’s make a small change to the README, register the change with Git (this is called a <em>commit</em>), and push the changes upstream to GitHub (which has the <em>remote</em> copy of the repository).</p>
<section id="step-1.-clone-the-repository" class="level4">
<h4 class="anchored" data-anchor-id="step-1.-clone-the-repository">Step 1. Clone the repository</h4>
<p>First make a local copy of the repository from the remote copy on GitHub. It’s best do this <strong>outside</strong> of the <code>compute-skills-2025</code> directory; otherwise you’ll have a repository nested within a repository.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">## First `cd` to your home directory to avoid cloning a repo within a repo.</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> clone https://github.com/<span class="op">&lt;</span>your_username<span class="op">&gt;</span>/newton-practice</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Now if we run this:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> newton-practice</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ls</span> <span class="at">-l</span> .git</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span> .git/config</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>we should see a bunch of output (truncated here) indicating that <code>newton-practice</code> is a Git repository, and that in this case the local repository is linked to a <em>remote</em> repository (the repository we created on GitHub):</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="ex">total</span> 40</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="ex">-rw-r--r--</span> 1 jovyan jovyan  264 Aug  2 15:04 config</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="ex">-rw-r--r--</span> 1 jovyan jovyan   73 Aug  2 15:04 description</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="ex">-rw-r--r--</span> 1 jovyan jovyan   21 Aug  2 15:04 HEAD</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="ex">-rw-r--r--</span>   1 paciorek scfstaff   16 Jul 24 14:48 COMMIT_EDITMSG</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="ex">-rw-r--r--</span>   1 paciorek scfstaff  656 Jul 23 18:20 config</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span>snip<span class="op">&gt;</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span>snip<span class="op">&gt;</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="ex">[remote</span> <span class="st">"origin"</span>]</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>        <span class="ex">url</span> = https://github.com/paciorek/newton-practice</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>        <span class="ex">fetch</span> = +refs/heads/<span class="pp">*</span>:refs/remotes/origin/<span class="pp">*</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span>snip<span class="op">&gt;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Step 2. Add files</p>
<p>Next move (or copy) your Python module into the repository directory. For the demo, I’ll use a version of the Newton code that I wrote that has some bugs in it (for later debugging). The file is not in the repository.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> ~/newton-practice</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cp</span> ../compute-skills-2025/units/newton-buggy.py newton.py</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co">## Tell git to track the file (put it in the staging area).</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> add newton.py</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The key thing is to make sure that you copy the code file into the directory of the new repository.</p>
<p>You can do this with <code>cp</code> in the shell as I did above.</p>
<p>If you’re learning to use the shell, it’s best to practice doing the copying in the shell, but if you really need to, you may be able to drag and move it within the DataHub file manager window pane.</p>
<p>Of if you have it on your laptop in a local file you edited there (instead of within DataHub), navigate to the directory of the new repository in the DataHub file manager window pane and click on the “Upload Files” button.</p>
<p>Step 3. Edit file(s)</p>
<p>Edit the README file to indicate that the repository has a basic implementation of Newton’s method.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Editing files">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Editing files
</div>
</div>
<div class="callout-body-container callout-body">
<p>Here are some options for opening an Editor to edit your code/markdown/text files.</p>
<ul>
<li>In DataHub, you can double-click on the file in the file manager to open an Editor window.</li>
<li>If you go to your repository on GitHub, and click into a file, you can either:
<ul>
<li>Click on the Pencil/Edit icon to edit the file, or</li>
<li>Press “.” (the period key), and GitHub will put you into a VS Code-based editor window.</li>
</ul></li>
<li>From the terminal in the DataHub, you can start an editor such as vim or emacs or nano by typing the name of the editor and (optionally) the name of the file you want to edit, e.g., <code>emacs README.md</code>).</li>
<li>You can start VS Code from within DataHub via <code>File -&gt; New Launcher</code> and then selecting the VS Code icon.</li>
<li>You can download and upload files to your laptop. This might be more comfortable for you for large edits, but it can be inconvenient for minor changes.</li>
</ul>
</div>
</div>
<div class="sourceCode" id="cb6"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> status</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co">## Tell git to keep track of the changes to the file.</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> add README.md</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> status</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb7"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Register the changes with Git.</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> commit <span class="at">-m</span><span class="st">"Add basic implementation of Newton's method."</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> status</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co">## Synchronize the changes with the remote.</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> push</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>We could have cloned the (public) repository without the <code>gh_scoped_creds</code> credentials stuff earlier, but if we tried to push to it, we would have been faced with GitHub asking for our password, which would have required us to create a GitHub authentication token that we would paste in.</p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Instead of having to <code>add</code> files that already part of the repository (such as <code>README.md</code>) we could do:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> commit <span class="at">-a</span> <span class="at">-m</span><span class="st">"Update README."</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>We do need to explicitly add any <strong>new</strong> files (e.g., <code>newton.py</code>) that are not yet registered with git via <code>git add</code>.</p>
<p>Caution: relying heavily on <code>-a</code> can result in commits that combine a bunch of unrelated changes (and possibly changes you didn’t want to commit). Omitting <code>-a</code> and using <code>git add</code> for each changed file gives you more control and is safer.</p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>You can also edit and add files directly to your GitHub repository in a browser window. This is a good backup if you run into problems making commits from DataHub or your laptop.</p>
</div>
</div>
</section>
<section id="writing-good-commit-messages" class="level3">
<h3 class="anchored" data-anchor-id="writing-good-commit-messages">Writing good commit messages</h3>
<p>Some tips:</p>
<ul>
<li>Concisely describe what changed (and for more complicated situations, why), not how.</li>
<li>Two options (depending on whether the commit makes one or more changes):
<ol type="1">
<li>Keep it short (one line, &lt;72 characters)</li>
<li>Have a subject line separated from the body by a blank line.
<ul>
<li>Keep subject to 50 characters and each body line to 72 characters.</li>
<li>Best to edit message in an editor: omit the <code>-m</code> flag to <code>git commit</code>.</li>
</ul></li>
</ol></li>
<li>If you’re working on a project with GitHub issues, reference the issue at the bottom.</li>
<li>Start each item in the message with a verb (present tense) and provide a complete sentence.</li>
</ul>
<p>If you find your commit message is covering multiple topics, it probably means you should have made multiple (“atomic”) commits.</p>
</section>
</section>
<section id="exercise-put-your-code-in-your-repository" class="level2">
<h2 class="anchored" data-anchor-id="exercise-put-your-code-in-your-repository">Exercise: Put your code in your repository</h2>
<p>Following the steps above, add your new code to your repository. Then commit it, providing a meaningful commit message.</p>
<p>You could push it to GitHub if you want, but that will be part of the exercise at the end of Section 3, so we’ll troubleshoot any problems with pushing to GitHub then.</p>
</section>
</section>
<section id="understanding-git" class="level1">
<h1>3. Understanding Git</h1>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
More than the syntax
</div>
</div>
<div class="callout-body-container callout-body">
<p>So far we’ve just introduced Git by its mechanics/syntax. This is ok (albeit not ideal) for basic one-person operation, but to really use Git effectively you need to understand conceptually how it works.</p>
<p>More generally if you understand things conceptually, then looking up the syntax of a command or the mechanics of how to do something will be straightforward.</p>
</div>
</div>
<p>We’ll start with some visuals and then go back to some Git terminology and to the structure of a repository.</p>
<section id="git-visuals-understanding-git-concepts" class="level2">
<h2 class="anchored" data-anchor-id="git-visuals-understanding-git-concepts">Git visuals: Understanding Git concepts</h2>
<p>Fernando’s Statistics 159/259 materials have a nice visualization (<a href="https://docs.google.com/presentation/d/1YlM3boYLE8DwbxGNO3ZVVt3e9gEoBgD1uc9RtItUYCU">online version</a>, <a href="git_visuals.pdf">PDF version</a>) of a basic Git workflow that we’ll walk through.</p>
<p>Note that we haven’t actually seen in practice some of what is shown in the visual: tags, branches, and merging, but we’ll be using those ideas later.</p>
<p><a href="https://ucb-stat-159-s23.github.io/site/lectures/intro-git/git-visuals.html">Fernando’s lecture materials from Statistics 159/259</a> illustrate that the steps shown in the visualization correspond exactly to what happens when running the Git commands from the command line.</p>
</section>
<section id="key-components-and-terminology" class="level2">
<h2 class="anchored" data-anchor-id="key-components-and-terminology">Key components and terminology</h2>
<section id="commits" class="level3">
<h3 class="anchored" data-anchor-id="commits">Commits</h3>
<p>A <em>commit</em> is a snapshot of our work at a point in time. So far in our own repository, we’ve been working with a linear sequence of snapshots, but the visualization showed that we can actually have a directed acyclic graph (DAG) of snapshots once we have <em>branches</em>.</p>
<p>Each commit has:</p>
<ul>
<li>a hash identifier - a unique identifier produced by hashing the changes introduced in the commit and also the parent commit,</li>
<li>hashes of the files in the repository in their current state, and</li>
<li>the changes (based on the <code>diff</code> tool) relative to the parent commit.</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="commit.png" title="visualization of a git commit" class="img-fluid figure-img"></p>
<figcaption>Figure: A Git commit (Credit: ProGit book, CC License)</figcaption>
</figure>
</div>
<p>We identify each node (commit) with a hash, a fingerprint of the content of each commit and its parent. It is important the fact that the hash includes information of the parent node, since this allow us to keep the check the structural consistency of the DAG.</p>
<p>We can illustrate what Git is doing easily in Python.</p>
<p>Let’s create a first hash:</p>
<div id="b57d06ac" class="cell" data-execution_count="2">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> hashlib <span class="im">import</span> sha1</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Our first commit</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>data1 <span class="op">=</span> <span class="st">b'This is the start of my paper.'</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>meta1 <span class="op">=</span> <span class="st">b'date: 1/1/17'</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>hash1 <span class="op">=</span> sha1(data1 <span class="op">+</span> meta1).hexdigest( )</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Hash:'</span>, hash1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Hash: 3b32905baabd5ff22b3832c892078f78f5e5bd3b</code></pre>
</div>
</div>
<p>￼ Every small change we make on the previous text with result in a full change of the associated hash code. Notice also how in the next hash we have included the information of the parent node.</p>
<div id="97d576d1" class="cell" data-execution_count="3">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>data2 <span class="op">=</span> <span class="st">b'Some more text in my paper...'</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>meta2 <span class="op">=</span> <span class="st">b'date: 1/2/1'</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Note we add the parent hash here!</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>hash2 <span class="op">=</span> sha1(data2 <span class="op">+</span> meta2 <span class="op">+</span> hash1.encode()).hexdigest()</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Hash:'</span>, hash2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Hash: 1c12d2aad51d5fc33e5b83a03b8787dfadde92a4</code></pre>
</div>
</div>
</section>
<section id="a-repository" class="level3">
<h3 class="anchored" data-anchor-id="a-repository">A repository</h3>
<p>A <em>repository</em> is the set of files for a project with their history. It’s a collection of commits in the form of an directed acyclic graph.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="tree.png" title="visualization of a git repository (directed acyclic graph of commits)" class="img-fluid figure-img"></p>
<figcaption>Figure: A (simple) Git repository (Credit: ProGit book, CC License)</figcaption>
</figure>
</div>
<p>Some other terms:</p>
<ul>
<li><em>HEAD</em>: a pointer to the current commit</li>
<li><em>tag</em>: a label for a commit</li>
<li><em>branch</em>: a commit - often indicating a commit that has “branched” off of some main workflow or some linear sequence of commits</li>
</ul>
</section>
<section id="staging-area-index" class="level3">
<h3 class="anchored" data-anchor-id="staging-area-index">Staging area / index</h3>
<p>The index (staging area) keeps track of changes (made to tracked files) that are added, but that are not yet committed.</p>
<p>Here’s a high-level overview of how the staging area relates to the other pieces of what we’ve been doing.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="staging.png" title="Visualization of local operations in Git" class="img-fluid figure-img"></p>
<figcaption>Figure: Local operations in a repository (Credit: ProGit book, CC License)</figcaption>
</figure>
</div>
<p>And here’s a more-detailed visualization of how various Git commands relate to your current directory, the staging area and the repository.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="git-remote.png" title="Visualization of operations with and parts of Git" class="img-fluid figure-img"></p>
<figcaption>Figure: detailed operations in a repository (Credit: Research Software Engineering with Python, CC License)</figcaption>
</figure>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Rolling back changes (optional)
</div>
</div>
<div class="callout-body-container callout-body">
<p>Once we have a conceptual understanding, then the commands used to undo or modify changes we’ve made are easier to understand, though often one has to look up the particular specific commands.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" aria-current="page">Uncommitted changes</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Staged, uncommitted changes</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">Committed changes</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-4" role="tab" aria-controls="tabset-1-4" aria-selected="false">Pushed changes</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p>If I make some changes to a file that I decide are a mistake, before <code>git add</code> (i.e., before registering/staging the changes with <code>git</code>), I can always still edit the file to undo the mistakes.</p>
<p>But I can also go back to the version stored by Git.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Current, recommended syntax:</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> restore file.txt</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Alternative (older) syntax:</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co"># git checkout -- file.txt  </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<p>If we’ve added (staged) files via <code>git add</code> but have not yet committed them, the files are in the index (staging area). We can get those changes out of the staging area like this:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> status</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Current, recommended syntax:</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> restore <span class="at">--staged</span> file.txt</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Alternative (older) syntax:</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="co"># git reset HEAD file.txt  # This is older syntax.</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> status</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Note that the changes still exist in <code>file.txt</code> but they’re no longer registered/staged with Git.</p>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<p>Suppose you need to add or modify to your commit. This illustrates a few things you might do to update your commit.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> commit <span class="at">-m</span> <span class="st">'Some commit'</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co">## 1. Perhaps you forgot to include a new file.</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> add forgotten_file.txt</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="co">## 2. Perhaps you forgot to edit an existing file.</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Edit file.txt.</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> add file.txt</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="co">## 3. Perhaps you need to get a version of a file from before.</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Get version of file from previous commit.</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> checkout <span class="op">&lt;</span>commit_hash<span class="op">&gt;</span> file.txt</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> commit <span class="at">--amend</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Alternatively suppose you want to undo a commit:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">## To go back to the previous commit, but leave the changes in the working directory.</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> reset HEAD~1</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="co">## To go back to a specific commit.</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> reset <span class="op">&lt;</span>commit_hash<span class="op">&gt;</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="co">## To go back to a previous commit and remove any changes in the working directory.</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> reset <span class="at">--hard</span> <span class="op">&lt;</span>commit_hash<span class="op">&gt;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-1-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-4-tab">
<div class="sourceCode" id="cb17"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> revert <span class="op">&lt;</span>commit_hash<span class="op">&gt;</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> push</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Note that this creates a new commit that undoes the changes you don’t want. So the undoing shows up in the history. This is the safest option.</p>
<p>If you’re <em>sure</em> no one else has pulled your changes from the remote:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> reset <span class="op">&lt;</span>commit_hash<span class="op">&gt;</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Make changes</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> commit <span class="at">-a</span> <span class="at">-m</span><span class="st">'Rework the mistake.'</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> push <span class="at">-f</span> origin <span class="op">&lt;</span>branch_name<span class="op">&gt;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>This will remove the previous commit at the remote (GitHub in our case).</p>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="exercise-code-review-with-a-partner" class="level2">
<h2 class="anchored" data-anchor-id="exercise-code-review-with-a-partner">Exercise: code review (with a partner)</h2>
<section id="step-0-push-your-changes-to-github" class="level4">
<h4 class="anchored" data-anchor-id="step-0-push-your-changes-to-github">Step 0: Push your changes to GitHub</h4>
<p>This will make them easily available to your partner and mimics the process we want/need to use anyway when interacting with remote collaborators or working asynchronously. Do your collaboration on GitHub, which is designed to help with collaboration, and not via email/text/etc.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> push</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="step-1-make-suggestions" class="level4">
<h4 class="anchored" data-anchor-id="step-1-make-suggestions">Step 1: Make suggestions</h4>
<p>Go to your partner’s repository at <code>https://github.com/&lt;user_name&gt;/newton-practice</code>.</p>
<ol type="1">
<li>Look over their code.</li>
<li>Make some comments/suggestions in a new GitHub issue (go to the <code>Issues</code> button and click on <code>New issue</code>).</li>
</ol>
</section>
<section id="step-2-respond-to-suggestions" class="level4">
<h4 class="anchored" data-anchor-id="step-2-respond-to-suggestions">Step 2: Respond to suggestions</h4>
<p>In response to your partner’s comments, make some small change(s) to your <code>newton.py</code> code.</p>
<p>You can do this in DataHub (or locally on your laptop if that’s what you’re doing) and make a commit as we did in the previous exercise.</p>
<p>Or you can do the editing in your GitHub browser window by clicking on the file and choosing the pencil icon (far right) to edit it. When you save it, a commit will be made. Make sure to provide a commit message. You can also create new files via the <code>+</code> button in the top of the left sidebar. If you make changes directly on GitHub, you’ll also want to run <code>git pull</code> to pull down the changes to your local repository on DataHub.</p>
</section>
</section>
</section>
<section id="code-style-and-documentation" class="level1">
<h1>4. Code style and documentation</h1>
<p>Having a (reasonably) consistent and clean style, plus documentation, is important for being able to read and maintain your code.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-14-contents" aria-controls="callout-14" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Q: Who is the person most likely to use your code again?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-14" class="callout-14-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>A: You, but at some point in the future by which you will have forgotten what the code does and why.</p>
<p>I can’t tell you how many times I’ve looked back at my own code and been amazed at how little I remember and frustrated with the former self who wrote it.</p>
</div>
</div>
</div>
<p>A go-to reference on Python code style is the <a href="https://peps.python.org/pep-0008">PEP8 style guide</a>. That said, it’s extensive, quite detailed, and hard to absorb quickly.</p>
<p>Here are a few key suggestions:</p>
<ul>
<li><p>Indentation:</p>
<ul>
<li>Python is strict about indentation of course.</li>
<li>Use 4 spaces per indentation level (avoid tabs if possible).</li>
</ul></li>
<li><p>Whitespace: use it in a variety of places. Some places where it is good to have it are</p>
<ul>
<li>around operators (assignment and arithmetic), e.g., <code>x = x * 3</code>;</li>
<li>between function arguments, e.g., <code>myfun(x, 3, data)</code>;</li>
<li>between list/tuple elements, e.g., <code>x = [3, 5, 7]</code>; and</li>
<li>between matrix/array indices, e.g., <code>x[3, :4]</code>.</li>
</ul></li>
<li><p>Use blank lines to separate blocks of code with comments to say what the block does.</p></li>
<li><p>Use whitespaces or parentheses for clarity even if not needed for order of operations. For example, <code>a/y*x</code> will work but is not easy to read and you can easily induce a bug if you forget the order of ops. Instead, use <code>a/y * x</code> or <code>(a/y) * x</code>.</p></li>
<li><p>Avoid code lines longer than 79 characters and comment/docstring lines longer than 72 characters.</p></li>
<li><p>Comments:</p>
<ul>
<li>Add comments to explain <em>why</em>, not <em>how</em>.</li>
<li>Don’t restate the obvious; avoid things like <code>x = x + 1  # Increment x.</code>.</li>
<li>Some key things to document:
<ul>
<li>summarizing a block of code,</li>
<li>explaining a complicated piece of code or particular construction, and</li>
<li>explaining non-obvious values or steps, such as <code>x = x + 1 # Compensate for image border.</code></li>
</ul></li>
<li>Comments should generally be complete sentences.</li>
</ul></li>
<li><p>You can use parentheses to group operations such that they can be split up into lines and easily commented, e.g.,</p>
<div id="7684d0ed" class="cell" data-execution_count="4">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>newdf <span class="op">=</span> (</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>        pd.read_csv(<span class="st">'file.csv'</span>)                   <span class="co"># 1988 census data.</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>        .rename(columns <span class="op">=</span> {<span class="st">'STATE'</span>: <span class="st">'us_state'</span>})  <span class="co"># Adjust column names.</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>        .dropna()                                 <span class="co"># Remove rows with missing values.</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>        )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div></li>
<li><p>Being consistent about the naming style for objects and functions is hard, but try to be consistent. PEP8 suggests:</p>
<ul>
<li>Class names should be UpperCamelCase.</li>
<li>Function, method, and variable names should be snake_case, e.g., <code>number_of_its</code> or <code>n_its</code>.</li>
<li>Non-public methods and variables should have a leading underscore.</li>
</ul></li>
<li><p>Try to have the names be informative without being overly long.</p></li>
<li><p>Don’t overwrite names of objects/functions that already exist in the language. E.g., don’t use <code>len</code> in Python. That said, the namespace system helps with the unavoidable cases where there are name conflicts.</p></li>
<li><p>Use active names for functions (e.g., <code>calc_loglik</code>, <code>calc_log_lik</code> rather than <code>loglik</code> or <code>loglik_calc</code>). Functions are like to verbs in human language.</p></li>
<li><p>Learn from others’ code.</p></li>
</ul>
<section id="linting" class="level2">
<h2 class="anchored" data-anchor-id="linting">Linting</h2>
<p>Linting is the process of applying a tool to your code to enforce style.</p>
<p>We’ll demo using <code>ruff</code> to some example code. You might also consider <code>black</code>.</p>
<p>We’ll practice with <code>ruff</code> with a small module we’ll use next also for debugging.</p>
<ul>
<li><p>First, we check for and fix syntax errors.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ruff</span> check newton.py</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
<li><p>Then we ask <code>ruff</code> to reformat to conform to standard style.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cp</span> newton.py newton-save.py   <span class="co"># So we can see what `ruff` did.</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="ex">ruff</span> format newton.py</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
</ul>
<p>Let’s see what changed:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">diff</span> newton-save.py newton.py</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="exercise-add-documentation-and-comments-to-your-newton-module" class="level2">
<h2 class="anchored" data-anchor-id="exercise-add-documentation-and-comments-to-your-newton-module">Exercise: add documentation and comments to your Newton module</h2>
<ol type="1">
<li>Add a <a href="https://peps.python.org/pep-0257">doc string</a> to each of your functions. Focus on your main function. Take a look at an example, such as <code>help(numpy.linalg.cholesky)</code> to see the different parts and the format. Docstrings are also a good thing to ask an AI coding tool to help with.</li>
<li>Consider whether to add comments to your code.</li>
<li>Apply <code>ruff</code> to your code.</li>
<li>Compare the results with the style suggestions above and do additional reformatting as needed.</li>
<li>Commit and push to GitHub. Remember to have a good commit message!</li>
</ol>
</section>
</section>
<section id="debugging" class="level1">
<h1>5. Debugging</h1>
<p>Once you start writing more complicated code, even in an interpreted language such as Python that you can run line-by-line, you’ll want to use a debugger, particularly when you have nested function calls.</p>
<p>Debugging can be a slow process, so you typically start a debugging session by deciding which line in your code you would like to start tracing the behavior from, and you place a <em>breakpoint</em>. Then you can have the debugger run the program up to that point and stop at it, allowing you to:</p>
<ol type="1">
<li>inspect the current state of variables,</li>
<li>step through the code line by line,</li>
<li>step over or into functions as they are called, and</li>
<li>resume program execution.</li>
</ol>
<p>The <em>stack</em> is the series of nested function calls. When an error occurs, Python will print the <em>stack trace</em> showing the sequence of calls leading to the error. This can be helpful and distracting/confusing.</p>
<p>We’ll use the debugger in JupyterLab; similar functionality is in VS Code. And you can use <code>pdb</code> directly from the command line; the ideas are all the same.</p>
<section id="demo-debugging-my-newton-implementation" class="level2">
<h2 class="anchored" data-anchor-id="demo-debugging-my-newton-implementation">Demo: debugging my Newton implementation</h2>
<section id="using-the-jupyterlab-visual-debugger" class="level3">
<h3 class="anchored" data-anchor-id="using-the-jupyterlab-visual-debugger">Using the JupyterLab visual debugger</h3>
<p>Let’s debug my buggy implementation of Newton’s method.</p>
<div id="d97e6567" class="cell" data-execution_count="5">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> newton</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>newton.optimize(<span class="fl">2.95</span>, np.cos)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Clearly that doesn’t work. Let’s debug it.</p>
<p>We’ll work in our Jupyter notebook.</p>
<ul>
<li>First turn on debugging capability by clicking on the small “bug” icon of the top navigation bar under the file tabs and to the left of the info about the kernel.</li>
<li>Next we click on a line of code to set a breakpoint.</li>
<li>Now we run the function by executing the cell containing the function call. Using the icons in the <code>Callstack</code> pane, we can:
<ul>
<li>continue (to the end or the next breakpoint),</li>
<li>finish,</li>
<li>run the next line,</li>
<li>step (in/down) into a nested function</li>
<li>step (out/up) out of a function, or</li>
<li>evaluate an expression
<ul>
<li>the output may show up in the notebook, but one can also click on the “log” icon at the bottom and set the “Log Level” to “debug” to see the output in a separate logging pane at the bottom.</li>
</ul></li>
</ul></li>
</ul>
<p>Here are screenshots showing the steps/components of the visual debugger:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Access debugger</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Start execution</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false">Step into code</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-4" role="tab" aria-controls="tabset-2-4" aria-selected="false">Control execution</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-5" role="tab" aria-controls="tabset-2-5" aria-selected="false">Evaluate code</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-6" role="tab" aria-controls="tabset-2-6" aria-selected="false">View result</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<p><embed src="shot1a.pdf" title="Access the debugger" width="800" height="600"></p>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<p><embed src="shot2a.pdf" title="Set a breakpoint and start execution" width="800" height="600"></p>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<p><embed src="shot3a.pdf" title="Step into a function" width="800" height="600"></p>
</div>
<div id="tabset-2-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-4-tab">
<p><embed src="shot4a.pdf" title="Control execution" width="800" height="600"></p>
</div>
<div id="tabset-2-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-5-tab">
<p><embed src="shot5a.pdf" title="Evaluate code in context" width="800" height="600"></p>
</div>
<div id="tabset-2-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-6-tab">
<p><embed src="shot6a.pdf" title="View result of evaluation" width="800" height="600"></p>
</div>
</div>
</div>
<p>If we want to debug into functions defined in files, we can add <code>breakpoint()</code> in the location in the file where we want the breakpoint and one should see the code in the <code>SOURCE</code> box in the debugger panel. So far, I’ve found this to be a bit hard to use, but that may well just be my inexperience with the JupyterLab debugger.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Note that the value of <code>x_new</code> doesn’t show up automatically in the variables pane. This is probably because it is a numpy variable rather than a regular Python variable.</p>
</div>
</div>
</section>
<section id="using-the-ipython-debugger-ipdb" class="level3">
<h3 class="anchored" data-anchor-id="using-the-ipython-debugger-ipdb">Using the IPython debugger (<code>ipdb</code>)</h3>
<p>We can use the IPython <code>%debug</code> “magic” to activate a debugger as well.</p>
<p>One way this is particularly useful is “post-mortem” debugging, i.e., debugging when exceptions (errors) have occurred. We just invoke <code>%debug</code> and then (re)run the code that is failing. The <code>ipdb</code> debugger will be invoked when the error occurs.</p>
<p>Once in the ipdb debugger, we can use these commands (most of which correspond to icons we used to control the JupyterLab debugger behavior):</p>
<ul>
<li><code>c</code> to continue execution (until the end or the next breakpoint)</li>
<li><code>n</code> to run the next line of code</li>
<li><code>u</code> and <code>d</code> to step up and down through the stack of function calls</li>
<li><code>p expr</code> to print the result of the <code>expr</code> code</li>
<li><code>q</code> to quit the debugger</li>
</ul>
<p>We’ll put a silly error into the code, restart the kernel, and use the post-mortem debugging approach as an illustration.</p>
</section>
</section>
<section id="exercise-debugging-your-newton-code" class="level2">
<h2 class="anchored" data-anchor-id="exercise-debugging-your-newton-code">Exercise: debugging your Newton code</h2>
<p>Run your Newton method on the following function, <span class="math inline">\(x^4/4 - x^3 -x\)</span>, for various starting values. Sometimes it should fail.</p>
<p>Use the debugger to try to see what goes wrong. (For our purposes here, do this using the debugger; don’t figure it out from first principles mathematically or graphically.)</p>
<p>Conditional breakpoints are a useful tool that causes the debugger to stop at a breakpoint only if some condition is true (e.g., if some extreme value is reached in the Newton iterations). I don’t see that it’s possible to do this with the JupyterLab debugger, but with the <code>ipdb</code> debugger you can do things like this to debug a particular line of a particular file if a condition (here <code>x==5</code>) is met:</p>
<pre><code>b path/to/script.py:999, x==5</code></pre>
</section>
</section>
<section id="defensive-programming-error-checking-and-testing" class="level1">
<h1>6. Defensive programming, error checking and testing</h1>
<section id="demo-unit-tests-and-pytest" class="level2">
<h2 class="anchored" data-anchor-id="demo-unit-tests-and-pytest">Demo: Unit tests and <code>pytest</code></h2>
<p><code>pytest</code> is a very popular package/framework for testing.</p>
<p>We create test functions that check for the expected result.</p>
<p>We use <code>assert</code> statements. These are ways of generally setting up sanity checks in your code. They are usually used in development, or perhaps data analysis workflows, rather than production code. They are a core part of setting up tests such as here with <code>pytest</code>.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="ex">pytest</span> test_newton.py</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="exercise-test-cases" class="level2">
<h2 class="anchored" data-anchor-id="exercise-test-cases">Exercise: Test cases</h2>
<p>With a partner, brainstorm some test cases for your implementation of Newton’s method in terms of the user’s function and input values a user might provide.</p>
<p>In addition to cases where it should succeed, you’ll want to consider cases where Newton’s method fails and test whether the user gets an informative result. Of course as a starting point, the case we used for the debugging exercise is a good one for a failing case.</p>
<p>We’ll collect some possible tests once each group has had a chance to brainstorm.</p>
</section>
<section id="exercise-unit-tests" class="level2">
<h2 class="anchored" data-anchor-id="exercise-unit-tests">Exercise: Unit tests</h2>
<p>Implement your test cases as unit tests using the <code>pytest</code> package.</p>
<p>Include tests for:</p>
<ul>
<li>successful optimization</li>
<li>unsuccessful optimization</li>
<li>invalid user inputs</li>
</ul>
<p>with the expected output being what you <em>want</em> to happen, not necessarily what your function does.</p>
<p>You’ll want cases where you know the correct answer. Start simple.</p>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Only write tests now
</div>
</div>
<div class="callout-body-container callout-body">
<p>For now don’t modify your code even if you start to suspect how it might fail. Writing the tests and then modifying code so they pass is an example of <em>test-driven development</em>.</p>
</div>
</div>
</section>
<section id="exceptions-in-python" class="level2">
<h2 class="anchored" data-anchor-id="exceptions-in-python">Exceptions in Python</h2>
<p>To understand how Python handles error, you can take a look at the <a href="https://swcarpentry.github.io/python-novice-inflammation/09-errors.html" target="_blank">Errors and Exceptions section</a> of the Software Carpentry workshop. The primary ideas covered are understanding error messages and tracebacks.</p>
</section>
<section id="exercise-error-trapping-robust-code-and-defensive-programming" class="level2">
<h2 class="anchored" data-anchor-id="exercise-error-trapping-robust-code-and-defensive-programming">Exercise: Error trapping, robust code, and defensive programming</h2>
<p>Now we’ll try to go beyond simply returning a failed result and see if we can trap problems early on and write more robust code.</p>
<p>Work on the following improvements:</p>
<ul>
<li>Check user inputs are valid.</li>
<li>Add warnings to the user if it seems that Newton’s method is taking a bad step.</li>
<li>Modify your function so that when it fails, the result is informative to the user.
<ul>
<li>Include a success/failure code (flag) in your output.</li>
</ul></li>
</ul>
<p>Your code should handle errors using exceptions, as discussed earlier for Python itself. We don’t have time to go fully into how Python handles the wide variety of exceptions. But here are a few basic things you can do to <em>raise</em> an <em>exception</em> (i.e., to report an error and stop execution):</p>
<pre><code>if not callable(f):
   raise TypeError(f"Argument is not a function, it is of type {type(f)}")</code></pre>
<pre><code>if x &gt; 1e7:
   raise RuntimeError(f"At iteration {iter}, optimization appears to be diverging")</code></pre>
<pre><code>import warnings
if x &gt; 3:
   warnings.warn(f"{x} is greater than 3.", UserWarning)</code></pre>
<p>Next, if you have time, consider robustifying your code:</p>
<ul>
<li>What might you do to modify what the algorithm does if the next step is worse than the current position?<br>
</li>
<li>What might you do if the next step is outside the range of potential values (assuming a unimodal function)?</li>
</ul>


<!-- -->

</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/berkeley-scf\.github\.io\/compute-skills-2025");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb30" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Version control, programming, and testing"</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="co">    theme: cosmo</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="co">    css: ../styles.css</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a><span class="co">    code-copy: true</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a><span class="co">    code-block-background: true</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: show</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a><span class="co">  freeze: auto</span></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a><span class="fu">## Overview</span></span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>This module presents the core content of the workshop on version control (using Git), code style, documentation, and testing.</span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>{{&lt; include ai.qmd &gt;}}</span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a><span class="fu"># 1. Our running example: Newton's method for optimization</span></span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a><span class="fu">## Newton's method background</span></span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a>We'll use a running example, Newton's method for optimization, during this workshop. It's simple enough to be straightforward to code but can involve various modifications, extensions, etc. to be a rich enough example that we can use it to demonstrate various topics and tools.</span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a>Recall that Newton's method works as follows to optimize some objective function, $f(x)$, as a function of univariate or multivariate $x$, where $f(x)$ is univariate. </span>
<span id="cb30-31"><a href="#cb30-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-32"><a href="#cb30-32" aria-hidden="true" tabindex="-1"></a>Newton's method is iterative. If we are at step $t-1$, the next value (when minimizing a function of univariate $x$) is:</span>
<span id="cb30-33"><a href="#cb30-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-34"><a href="#cb30-34" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb30-35"><a href="#cb30-35" aria-hidden="true" tabindex="-1"></a>x_t = x_{t-1} - f^{\prime}(x_{t-1}) / f^{\prime\prime}(x_{t-1})</span>
<span id="cb30-36"><a href="#cb30-36" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb30-37"><a href="#cb30-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-38"><a href="#cb30-38" aria-hidden="true" tabindex="-1"></a>Here are the steps:</span>
<span id="cb30-39"><a href="#cb30-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-40"><a href="#cb30-40" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>determine a starting value, $x_0$</span>
<span id="cb30-41"><a href="#cb30-41" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>iterate:</span>
<span id="cb30-42"><a href="#cb30-42" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>at step $t$, the next value (the update) is given by the equation above</span>
<span id="cb30-43"><a href="#cb30-43" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>stop when $\left\Vert x_{t} - x_{t-1} \right\Vert$ is "small"</span>
<span id="cb30-44"><a href="#cb30-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-45"><a href="#cb30-45" aria-hidden="true" tabindex="-1"></a>You can derive it by finding the root (aka zero) of the gradient function using a Taylor series approximation to the gradient.</span>
<span id="cb30-46"><a href="#cb30-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-47"><a href="#cb30-47" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exercise: Implement univariate Newton's method</span></span>
<span id="cb30-48"><a href="#cb30-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-49"><a href="#cb30-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-50"><a href="#cb30-50" aria-hidden="true" tabindex="-1"></a>Here's what you'll need your code to do:</span>
<span id="cb30-51"><a href="#cb30-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-52"><a href="#cb30-52" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>accept a starting value, $x_0$, and the function, $f(\cdot)$, to optimize</span>
<span id="cb30-53"><a href="#cb30-53" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>implement the iterative algorithm</span>
<span id="cb30-54"><a href="#cb30-54" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>implement the stopping criterion (feel free to keep this simple)</span>
<span id="cb30-55"><a href="#cb30-55" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>calculate the first and second derivatives using a basic finite difference approach to estimating the derivative based on the definition of a derivative as a limit</span>
<span id="cb30-56"><a href="#cb30-56" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>note that the second derivative can be seen as calling the first derivative twice...</span>
<span id="cb30-57"><a href="#cb30-57" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>consider what to return as the output (feel free to keep it simple)</span>
<span id="cb30-58"><a href="#cb30-58" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>don't worry much for now about making your code robust or dealing with tricky situations</span>
<span id="cb30-59"><a href="#cb30-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-60"><a href="#cb30-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-61"><a href="#cb30-61" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb30-62"><a href="#cb30-62" aria-hidden="true" tabindex="-1"></a>::: {.callout-warning}</span>
<span id="cb30-63"><a href="#cb30-63" aria-hidden="true" tabindex="-1"></a>Don't make your finite difference ("epsilon") too small or you'll actually get inaccurate estimates. (We'll discuss why when we talk a bit about <span class="co">[</span><span class="ot">numerical issues in computing</span><span class="co">](additional-topics.html#calculation-errors)</span> later.)</span>
<span id="cb30-64"><a href="#cb30-64" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb30-65"><a href="#cb30-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-66"><a href="#cb30-66" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb30-67"><a href="#cb30-67" aria-hidden="true" tabindex="-1"></a>For now, please do not use any Python packages that provide finite difference-based derivatives. (We'll do that later, and it's helpful to have more code available for the work we'll do today.)</span>
<span id="cb30-68"><a href="#cb30-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-69"><a href="#cb30-69" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb30-70"><a href="#cb30-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-71"><a href="#cb30-71" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip}</span>
<span id="cb30-72"><a href="#cb30-72" aria-hidden="true" tabindex="-1"></a>You're welcome to develop your code in a Jupyter Notebook, in the DataHub editor, in a separate editor on your laptop, or in VS Code on the DataHub (or your laptop).</span>
<span id="cb30-73"><a href="#cb30-73" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb30-74"><a href="#cb30-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-75"><a href="#cb30-75" aria-hidden="true" tabindex="-1"></a>Once you've written your Python functions, put your code into a simple text file, called <span class="in">`newton.py`</span>. In doing so you've created a Python *module*.</span>
<span id="cb30-76"><a href="#cb30-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-77"><a href="#cb30-77" aria-hidden="true" tabindex="-1"></a>::: {.callout-warning}</span>
<span id="cb30-78"><a href="#cb30-78" aria-hidden="true" tabindex="-1"></a>Don't use a Jupyter notebook (.ipynb) file at this stage, as it won't work as a *module* and is not handled in git in the same nice manner as simple text files.</span>
<span id="cb30-79"><a href="#cb30-79" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb30-80"><a href="#cb30-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-81"><a href="#cb30-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-82"><a href="#cb30-82" aria-hidden="true" tabindex="-1"></a>Once you have your module, you can use it like this:</span>
<span id="cb30-83"><a href="#cb30-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-86"><a href="#cb30-86" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb30-87"><a href="#cb30-87" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb30-88"><a href="#cb30-88" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> newton</span>
<span id="cb30-89"><a href="#cb30-89" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb30-90"><a href="#cb30-90" aria-hidden="true" tabindex="-1"></a>newton.optimize(start, fun)   <span class="co">## Assuming your function is called `optimize`.</span></span>
<span id="cb30-91"><a href="#cb30-91" aria-hidden="true" tabindex="-1"></a>newton.optimize(<span class="fl">2.5</span>, np.cos)  <span class="co">## Minimizing cos(x) from close-ish to one minimum.</span></span>
<span id="cb30-92"><a href="#cb30-92" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-93"><a href="#cb30-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-94"><a href="#cb30-94" aria-hidden="true" tabindex="-1"></a>A *module* is a collection of related code in a file with the extension <span class="in">`.py`</span>.</span>
<span id="cb30-95"><a href="#cb30-95" aria-hidden="true" tabindex="-1"></a>The code can include functions, classes, and variables, as well as</span>
<span id="cb30-96"><a href="#cb30-96" aria-hidden="true" tabindex="-1"></a>runnable code. To access the objects in the module, you need to import the module.</span>
<span id="cb30-97"><a href="#cb30-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-98"><a href="#cb30-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-99"><a href="#cb30-99" aria-hidden="true" tabindex="-1"></a><span class="fu"># 2. Introduction to Git and GitHub</span></span>
<span id="cb30-100"><a href="#cb30-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-101"><a href="#cb30-101" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exercise: Creating a Git repository (on GitHub)</span></span>
<span id="cb30-102"><a href="#cb30-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-103"><a href="#cb30-103" aria-hidden="true" tabindex="-1"></a>Go to <span class="in">`github.com/&lt;your_username&gt;`</span> and click on the <span class="in">`Repositories`</span> tag. Then click on the <span class="in">`New`</span> button.</span>
<span id="cb30-104"><a href="#cb30-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-105"><a href="#cb30-105" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>In the form, give the repository the name <span class="in">`newton-practice`</span> (so others who are working with you can find it easily)</span>
<span id="cb30-106"><a href="#cb30-106" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Provide a short description</span>
<span id="cb30-107"><a href="#cb30-107" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Click on "Add a README file".</span>
<span id="cb30-108"><a href="#cb30-108" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Leave the repository as "Public" so that others can interact with your repository when we practice later.</span>
<span id="cb30-109"><a href="#cb30-109" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Scroll down to select <span class="in">`Python`</span> under <span class="in">`Add .gitignore`</span>.</span>
<span id="cb30-110"><a href="#cb30-110" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Select a license (the BSD 3 Clause license is a good "permissive" one).</span>
<span id="cb30-111"><a href="#cb30-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-112"><a href="#cb30-112" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb30-113"><a href="#cb30-113" aria-hidden="true" tabindex="-1"></a><span class="fu">## Creating repositories on your laptop first</span></span>
<span id="cb30-114"><a href="#cb30-114" aria-hidden="true" tabindex="-1"></a>It's also possible to <span class="co">[</span><span class="ot">create the repository from the terminal on your machine</span><span class="co">](https://docs.github.com/en/migrations/importing-source-code/using-the-command-line-to-import-source-code/adding-locally-hosted-code-to-github#initializing-a-git-repository)</span> and then link it to your GitHub account, but that's a couple extra steps we won't go into here at the moment.</span>
<span id="cb30-115"><a href="#cb30-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-116"><a href="#cb30-116" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb30-117"><a href="#cb30-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-118"><a href="#cb30-118" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exercise: Accessing  GitHub repositories from DataHub</span></span>
<span id="cb30-119"><a href="#cb30-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-120"><a href="#cb30-120" aria-hidden="true" tabindex="-1"></a>Authenticating with GitHub can be a bit tricky, particularly when using DataHub (i.e., JupyterHub).</span>
<span id="cb30-121"><a href="#cb30-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-122"><a href="#cb30-122" aria-hidden="true" tabindex="-1"></a>Please follow <span class="co">[</span><span class="ot">these instructions</span><span class="co">](../prep.qmd#accessing-github-repositories-from-datahub)</span>.</span>
<span id="cb30-123"><a href="#cb30-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-124"><a href="#cb30-124" aria-hidden="true" tabindex="-1"></a><span class="fu">## Basic use of a repository</span></span>
<span id="cb30-125"><a href="#cb30-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-126"><a href="#cb30-126" aria-hidden="true" tabindex="-1"></a>In the terminal, let's make a small change to the README, register the change with Git (this is called a *commit*), and push the changes upstream to GitHub (which has the *remote* copy of the repository).</span>
<span id="cb30-127"><a href="#cb30-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-128"><a href="#cb30-128" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Step 1. Clone the repository</span></span>
<span id="cb30-129"><a href="#cb30-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-130"><a href="#cb30-130" aria-hidden="true" tabindex="-1"></a>First make a local copy of the repository from the remote copy on GitHub. It's best do this **outside** of the <span class="in">`compute-skills-2025`</span> directory; otherwise you'll have a repository nested within a repository. </span>
<span id="cb30-131"><a href="#cb30-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-132"><a href="#cb30-132" aria-hidden="true" tabindex="-1"></a><span class="in">```bash</span></span>
<span id="cb30-133"><a href="#cb30-133" aria-hidden="true" tabindex="-1"></a><span class="co">## First `cd` to your home directory to avoid cloning a repo within a repo.</span></span>
<span id="cb30-134"><a href="#cb30-134" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span></span>
<span id="cb30-135"><a href="#cb30-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-136"><a href="#cb30-136" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> clone https://github.com/<span class="op">&lt;</span>your_username<span class="op">&gt;</span>/newton-practice</span>
<span id="cb30-137"><a href="#cb30-137" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-138"><a href="#cb30-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-139"><a href="#cb30-139" aria-hidden="true" tabindex="-1"></a>Now if we run this:</span>
<span id="cb30-140"><a href="#cb30-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-141"><a href="#cb30-141" aria-hidden="true" tabindex="-1"></a><span class="in">```bash</span></span>
<span id="cb30-142"><a href="#cb30-142" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> newton-practice</span>
<span id="cb30-143"><a href="#cb30-143" aria-hidden="true" tabindex="-1"></a><span class="fu">ls</span> <span class="at">-l</span> .git</span>
<span id="cb30-144"><a href="#cb30-144" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span> .git/config</span>
<span id="cb30-145"><a href="#cb30-145" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-146"><a href="#cb30-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-147"><a href="#cb30-147" aria-hidden="true" tabindex="-1"></a>we should see a bunch of output (truncated here) indicating that <span class="in">`newton-practice`</span> is a Git repository, and that in this case the local repository is linked to a *remote* repository (the repository we created on GitHub):</span>
<span id="cb30-148"><a href="#cb30-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-149"><a href="#cb30-149" aria-hidden="true" tabindex="-1"></a><span class="in">```bash</span></span>
<span id="cb30-150"><a href="#cb30-150" aria-hidden="true" tabindex="-1"></a><span class="ex">total</span> 40</span>
<span id="cb30-151"><a href="#cb30-151" aria-hidden="true" tabindex="-1"></a><span class="ex">-rw-r--r--</span> 1 jovyan jovyan  264 Aug  2 15:04 config</span>
<span id="cb30-152"><a href="#cb30-152" aria-hidden="true" tabindex="-1"></a><span class="ex">-rw-r--r--</span> 1 jovyan jovyan   73 Aug  2 15:04 description</span>
<span id="cb30-153"><a href="#cb30-153" aria-hidden="true" tabindex="-1"></a><span class="ex">-rw-r--r--</span> 1 jovyan jovyan   21 Aug  2 15:04 HEAD</span>
<span id="cb30-154"><a href="#cb30-154" aria-hidden="true" tabindex="-1"></a><span class="ex">-rw-r--r--</span>   1 paciorek scfstaff   16 Jul 24 14:48 COMMIT_EDITMSG</span>
<span id="cb30-155"><a href="#cb30-155" aria-hidden="true" tabindex="-1"></a><span class="ex">-rw-r--r--</span>   1 paciorek scfstaff  656 Jul 23 18:20 config</span>
<span id="cb30-156"><a href="#cb30-156" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span>snip<span class="op">&gt;</span></span>
<span id="cb30-157"><a href="#cb30-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-158"><a href="#cb30-158" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span>snip<span class="op">&gt;</span></span>
<span id="cb30-159"><a href="#cb30-159" aria-hidden="true" tabindex="-1"></a><span class="ex">[remote</span> <span class="st">"origin"</span>]</span>
<span id="cb30-160"><a href="#cb30-160" aria-hidden="true" tabindex="-1"></a>        <span class="ex">url</span> = https://github.com/paciorek/newton-practice</span>
<span id="cb30-161"><a href="#cb30-161" aria-hidden="true" tabindex="-1"></a>        <span class="ex">fetch</span> = +refs/heads/<span class="pp">*</span>:refs/remotes/origin/<span class="pp">*</span></span>
<span id="cb30-162"><a href="#cb30-162" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span>snip<span class="op">&gt;</span></span>
<span id="cb30-163"><a href="#cb30-163" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-164"><a href="#cb30-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-165"><a href="#cb30-165" aria-hidden="true" tabindex="-1"></a>Step 2. Add files</span>
<span id="cb30-166"><a href="#cb30-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-167"><a href="#cb30-167" aria-hidden="true" tabindex="-1"></a>Next move (or copy) your Python module into the repository directory. For the demo, I'll use a version of the Newton code that I wrote that has some bugs in it (for later debugging). The file is not in the repository.</span>
<span id="cb30-168"><a href="#cb30-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-169"><a href="#cb30-169" aria-hidden="true" tabindex="-1"></a><span class="in">```bash</span></span>
<span id="cb30-170"><a href="#cb30-170" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> ~/newton-practice</span>
<span id="cb30-171"><a href="#cb30-171" aria-hidden="true" tabindex="-1"></a><span class="fu">cp</span> ../compute-skills-2025/units/newton-buggy.py newton.py</span>
<span id="cb30-172"><a href="#cb30-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-173"><a href="#cb30-173" aria-hidden="true" tabindex="-1"></a><span class="co">## Tell git to track the file (put it in the staging area).</span></span>
<span id="cb30-174"><a href="#cb30-174" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> add newton.py</span>
<span id="cb30-175"><a href="#cb30-175" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-176"><a href="#cb30-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-177"><a href="#cb30-177" aria-hidden="true" tabindex="-1"></a>The key thing is to make sure that you copy the code file into the directory of the new repository.</span>
<span id="cb30-178"><a href="#cb30-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-179"><a href="#cb30-179" aria-hidden="true" tabindex="-1"></a>You can do this with <span class="in">`cp`</span> in the shell as I did above.</span>
<span id="cb30-180"><a href="#cb30-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-181"><a href="#cb30-181" aria-hidden="true" tabindex="-1"></a>If you're learning to use the shell, it's best to practice doing the copying in the shell, but if you really need to, you may be able to drag and move it within the DataHub file manager window pane.</span>
<span id="cb30-182"><a href="#cb30-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-183"><a href="#cb30-183" aria-hidden="true" tabindex="-1"></a>Of if you have it on your laptop in a local file you edited there (instead of within DataHub), navigate to the directory of the new repository in the DataHub file manager window pane and click on the "Upload Files" button. </span>
<span id="cb30-184"><a href="#cb30-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-185"><a href="#cb30-185" aria-hidden="true" tabindex="-1"></a>Step 3. Edit file(s)</span>
<span id="cb30-186"><a href="#cb30-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-187"><a href="#cb30-187" aria-hidden="true" tabindex="-1"></a>Edit the README file to indicate that the repository has a basic implementation</span>
<span id="cb30-188"><a href="#cb30-188" aria-hidden="true" tabindex="-1"></a>of Newton's method.</span>
<span id="cb30-189"><a href="#cb30-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-190"><a href="#cb30-190" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip title="Editing files"}</span>
<span id="cb30-191"><a href="#cb30-191" aria-hidden="true" tabindex="-1"></a>Here are some options for opening an Editor to edit your code/markdown/text files.</span>
<span id="cb30-192"><a href="#cb30-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-193"><a href="#cb30-193" aria-hidden="true" tabindex="-1"></a><span class="ss"> - </span>In DataHub, you can double-click on the file in the file manager to open an Editor window.</span>
<span id="cb30-194"><a href="#cb30-194" aria-hidden="true" tabindex="-1"></a><span class="ss"> - </span>If you go to your repository on GitHub, and click into a file, you can either:</span>
<span id="cb30-195"><a href="#cb30-195" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Click on the Pencil/Edit icon to edit the file, or</span>
<span id="cb30-196"><a href="#cb30-196" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Press "." (the period key), and GitHub will put you into a VS Code-based editor window.</span>
<span id="cb30-197"><a href="#cb30-197" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>From the terminal in the DataHub, you can start an editor such as vim or emacs or nano by typing the name of the editor and (optionally) the name of the file you want to edit, e.g., <span class="in">`emacs README.md`</span>).</span>
<span id="cb30-198"><a href="#cb30-198" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>You can start VS Code from within DataHub via <span class="in">`File -&gt; New Launcher`</span> and then selecting the VS Code icon. </span>
<span id="cb30-199"><a href="#cb30-199" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>You can download and upload files to your laptop. This might be more comfortable for you for large edits, but it can be inconvenient for minor changes.</span>
<span id="cb30-200"><a href="#cb30-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-201"><a href="#cb30-201" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb30-202"><a href="#cb30-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-203"><a href="#cb30-203" aria-hidden="true" tabindex="-1"></a><span class="in">```bash</span></span>
<span id="cb30-204"><a href="#cb30-204" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> status</span>
<span id="cb30-205"><a href="#cb30-205" aria-hidden="true" tabindex="-1"></a><span class="co">## Tell git to keep track of the changes to the file.</span></span>
<span id="cb30-206"><a href="#cb30-206" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> add README.md</span>
<span id="cb30-207"><a href="#cb30-207" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> status</span>
<span id="cb30-208"><a href="#cb30-208" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-209"><a href="#cb30-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-210"><a href="#cb30-210" aria-hidden="true" tabindex="-1"></a><span class="in">```bash</span></span>
<span id="cb30-211"><a href="#cb30-211" aria-hidden="true" tabindex="-1"></a><span class="co">## Register the changes with Git.</span></span>
<span id="cb30-212"><a href="#cb30-212" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> commit <span class="at">-m</span><span class="st">"Add basic implementation of Newton's method."</span></span>
<span id="cb30-213"><a href="#cb30-213" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> status</span>
<span id="cb30-214"><a href="#cb30-214" aria-hidden="true" tabindex="-1"></a><span class="co">## Synchronize the changes with the remote.</span></span>
<span id="cb30-215"><a href="#cb30-215" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> push</span>
<span id="cb30-216"><a href="#cb30-216" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-217"><a href="#cb30-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-218"><a href="#cb30-218" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb30-219"><a href="#cb30-219" aria-hidden="true" tabindex="-1"></a>We could have cloned the (public) repository without the <span class="in">`gh_scoped_creds`</span> credentials stuff earlier, but if we tried to push to it, we would have been faced with GitHub asking for our password, which would have required us to create a GitHub authentication token that we would paste in.</span>
<span id="cb30-220"><a href="#cb30-220" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb30-221"><a href="#cb30-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-222"><a href="#cb30-222" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb30-223"><a href="#cb30-223" aria-hidden="true" tabindex="-1"></a>Instead of having to <span class="in">`add`</span> files that already part of the repository (such as <span class="in">`README.md`</span>) we could do:</span>
<span id="cb30-224"><a href="#cb30-224" aria-hidden="true" tabindex="-1"></a><span class="in">```bash</span></span>
<span id="cb30-225"><a href="#cb30-225" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> commit <span class="at">-a</span> <span class="at">-m</span><span class="st">"Update README."</span></span>
<span id="cb30-226"><a href="#cb30-226" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-227"><a href="#cb30-227" aria-hidden="true" tabindex="-1"></a>We do need to explicitly add any **new** files (e.g., <span class="in">`newton.py`</span>) that are not yet registered with git via <span class="in">`git add`</span>.</span>
<span id="cb30-228"><a href="#cb30-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-229"><a href="#cb30-229" aria-hidden="true" tabindex="-1"></a>Caution: relying heavily on <span class="in">`-a`</span> can result in commits that combine a bunch of unrelated changes (and possibly changes you didn't want to commit). Omitting <span class="in">`-a`</span> and using <span class="in">`git add`</span> for each changed file gives you more control and is safer.</span>
<span id="cb30-230"><a href="#cb30-230" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb30-231"><a href="#cb30-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-232"><a href="#cb30-232" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb30-233"><a href="#cb30-233" aria-hidden="true" tabindex="-1"></a>You can also edit and add files directly to your GitHub repository in a browser window. This is a good backup if you run into problems making commits from DataHub or your laptop.</span>
<span id="cb30-234"><a href="#cb30-234" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb30-235"><a href="#cb30-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-236"><a href="#cb30-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-237"><a href="#cb30-237" aria-hidden="true" tabindex="-1"></a><span class="fu">### Writing good commit messages</span></span>
<span id="cb30-238"><a href="#cb30-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-239"><a href="#cb30-239" aria-hidden="true" tabindex="-1"></a>Some tips:</span>
<span id="cb30-240"><a href="#cb30-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-241"><a href="#cb30-241" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Concisely describe what changed (and for more complicated situations, why), not how.</span>
<span id="cb30-242"><a href="#cb30-242" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Two options (depending on whether the commit makes one or more changes):</span>
<span id="cb30-243"><a href="#cb30-243" aria-hidden="true" tabindex="-1"></a><span class="ss">  1. </span>Keep it short (one line, &lt;72 characters)</span>
<span id="cb30-244"><a href="#cb30-244" aria-hidden="true" tabindex="-1"></a><span class="ss">  2. </span>Have a subject line separated from the body by a blank line.</span>
<span id="cb30-245"><a href="#cb30-245" aria-hidden="true" tabindex="-1"></a><span class="ss">      - </span>Keep subject to 50 characters and each body line to 72 characters.</span>
<span id="cb30-246"><a href="#cb30-246" aria-hidden="true" tabindex="-1"></a><span class="ss">      - </span>Best to edit message in an editor: omit the <span class="in">`-m`</span> flag to <span class="in">`git commit`</span>.</span>
<span id="cb30-247"><a href="#cb30-247" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>If you're working on a project with GitHub issues, reference the issue at the bottom.</span>
<span id="cb30-248"><a href="#cb30-248" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Start each item in the message with a verb (present tense) and provide a complete sentence.</span>
<span id="cb30-249"><a href="#cb30-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-250"><a href="#cb30-250" aria-hidden="true" tabindex="-1"></a>If you find your commit message is covering multiple topics, it probably means you should</span>
<span id="cb30-251"><a href="#cb30-251" aria-hidden="true" tabindex="-1"></a>have made multiple ("atomic") commits.</span>
<span id="cb30-252"><a href="#cb30-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-253"><a href="#cb30-253" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exercise: Put your code in your repository</span></span>
<span id="cb30-254"><a href="#cb30-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-255"><a href="#cb30-255" aria-hidden="true" tabindex="-1"></a>Following the steps above, add your new code to your repository. Then commit it, providing a meaningful commit message.</span>
<span id="cb30-256"><a href="#cb30-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-257"><a href="#cb30-257" aria-hidden="true" tabindex="-1"></a>You could push it to GitHub if you want, but that will be part of the exercise at the end of Section 3, so we'll troubleshoot any problems with pushing to GitHub then.</span>
<span id="cb30-258"><a href="#cb30-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-259"><a href="#cb30-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-260"><a href="#cb30-260" aria-hidden="true" tabindex="-1"></a><span class="fu"># 3. Understanding Git</span></span>
<span id="cb30-261"><a href="#cb30-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-262"><a href="#cb30-262" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb30-263"><a href="#cb30-263" aria-hidden="true" tabindex="-1"></a><span class="fu">## More than the syntax</span></span>
<span id="cb30-264"><a href="#cb30-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-265"><a href="#cb30-265" aria-hidden="true" tabindex="-1"></a>So far we've just introduced Git by its mechanics/syntax. This is ok (albeit not ideal) for basic one-person operation, but to really use Git effectively you need to understand conceptually how it works.</span>
<span id="cb30-266"><a href="#cb30-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-267"><a href="#cb30-267" aria-hidden="true" tabindex="-1"></a>More generally if you understand things conceptually, then looking up the syntax of a command or the mechanics of how to do something will be straightforward.</span>
<span id="cb30-268"><a href="#cb30-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-269"><a href="#cb30-269" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb30-270"><a href="#cb30-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-271"><a href="#cb30-271" aria-hidden="true" tabindex="-1"></a>We'll start with some visuals and then go back to some Git terminology and to the structure of a repository.</span>
<span id="cb30-272"><a href="#cb30-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-273"><a href="#cb30-273" aria-hidden="true" tabindex="-1"></a><span class="fu">## Git visuals: Understanding Git concepts</span></span>
<span id="cb30-274"><a href="#cb30-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-275"><a href="#cb30-275" aria-hidden="true" tabindex="-1"></a>Fernando's Statistics 159/259 materials have a nice visualization (<span class="co">[</span><span class="ot">online version</span><span class="co">](https://docs.google.com/presentation/d/1YlM3boYLE8DwbxGNO3ZVVt3e9gEoBgD1uc9RtItUYCU)</span>, <span class="co">[</span><span class="ot">PDF version</span><span class="co">](git_visuals.pdf)</span>) of a basic Git workflow that we'll walk through.</span>
<span id="cb30-276"><a href="#cb30-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-277"><a href="#cb30-277" aria-hidden="true" tabindex="-1"></a>Note that we haven't actually seen in practice some of what is shown in the visual: tags, branches, and merging, but we'll be using those ideas later.</span>
<span id="cb30-278"><a href="#cb30-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-279"><a href="#cb30-279" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Fernando's lecture materials from Statistics 159/259</span><span class="co">](https://ucb-stat-159-s23.github.io/site/lectures/intro-git/git-visuals.html)</span> illustrate that the steps shown in the visualization correspond exactly to what happens when running the Git commands from the command line.</span>
<span id="cb30-280"><a href="#cb30-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-281"><a href="#cb30-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-282"><a href="#cb30-282" aria-hidden="true" tabindex="-1"></a><span class="fu">## Key components and terminology</span></span>
<span id="cb30-283"><a href="#cb30-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-284"><a href="#cb30-284" aria-hidden="true" tabindex="-1"></a><span class="fu">### Commits</span></span>
<span id="cb30-285"><a href="#cb30-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-286"><a href="#cb30-286" aria-hidden="true" tabindex="-1"></a>A *commit* is a snapshot of our work at a point in time. So far in our own repository, we've been working with a linear sequence of snapshots, but the visualization showed that we can actually have a directed acyclic graph (DAG) of snapshots once we have *branches*.</span>
<span id="cb30-287"><a href="#cb30-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-288"><a href="#cb30-288" aria-hidden="true" tabindex="-1"></a>Each commit has:</span>
<span id="cb30-289"><a href="#cb30-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-290"><a href="#cb30-290" aria-hidden="true" tabindex="-1"></a><span class="ss"> - </span>a hash identifier - a unique identifier produced by hashing the changes introduced in the commit and also the parent commit,</span>
<span id="cb30-291"><a href="#cb30-291" aria-hidden="true" tabindex="-1"></a><span class="ss"> - </span>hashes of the files in the repository in their current state, and</span>
<span id="cb30-292"><a href="#cb30-292" aria-hidden="true" tabindex="-1"></a><span class="ss"> - </span>the changes (based on the <span class="in">`diff`</span> tool) relative to the parent commit.</span>
<span id="cb30-293"><a href="#cb30-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-294"><a href="#cb30-294" aria-hidden="true" tabindex="-1"></a><span class="al">![Figure: A Git commit (Credit: ProGit book, CC License)](commit.png "visualization of a git commit")</span></span>
<span id="cb30-295"><a href="#cb30-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-296"><a href="#cb30-296" aria-hidden="true" tabindex="-1"></a>We identify each node (commit) with a hash, a fingerprint of the content of each commit and its parent. It is important the fact that the hash includes information of the parent node, since this allow us to keep the check the structural consistency of the DAG.</span>
<span id="cb30-297"><a href="#cb30-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-298"><a href="#cb30-298" aria-hidden="true" tabindex="-1"></a>We can illustrate what Git is doing easily in Python.</span>
<span id="cb30-299"><a href="#cb30-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-300"><a href="#cb30-300" aria-hidden="true" tabindex="-1"></a>Let’s create a first hash:</span>
<span id="cb30-301"><a href="#cb30-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-304"><a href="#cb30-304" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb30-305"><a href="#cb30-305" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> hashlib <span class="im">import</span> sha1</span>
<span id="cb30-306"><a href="#cb30-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-307"><a href="#cb30-307" aria-hidden="true" tabindex="-1"></a><span class="co"># Our first commit</span></span>
<span id="cb30-308"><a href="#cb30-308" aria-hidden="true" tabindex="-1"></a>data1 <span class="op">=</span> <span class="st">b'This is the start of my paper.'</span></span>
<span id="cb30-309"><a href="#cb30-309" aria-hidden="true" tabindex="-1"></a>meta1 <span class="op">=</span> <span class="st">b'date: 1/1/17'</span></span>
<span id="cb30-310"><a href="#cb30-310" aria-hidden="true" tabindex="-1"></a>hash1 <span class="op">=</span> sha1(data1 <span class="op">+</span> meta1).hexdigest( )</span>
<span id="cb30-311"><a href="#cb30-311" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Hash:'</span>, hash1)</span>
<span id="cb30-312"><a href="#cb30-312" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-313"><a href="#cb30-313" aria-hidden="true" tabindex="-1"></a>￼</span>
<span id="cb30-314"><a href="#cb30-314" aria-hidden="true" tabindex="-1"></a>Every small change we make on the previous text with result in a full change of the associated hash code. Notice also how in the next hash we have included the information of the parent node.</span>
<span id="cb30-315"><a href="#cb30-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-318"><a href="#cb30-318" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb30-319"><a href="#cb30-319" aria-hidden="true" tabindex="-1"></a>data2 <span class="op">=</span> <span class="st">b'Some more text in my paper...'</span></span>
<span id="cb30-320"><a href="#cb30-320" aria-hidden="true" tabindex="-1"></a>meta2 <span class="op">=</span> <span class="st">b'date: 1/2/1'</span></span>
<span id="cb30-321"><a href="#cb30-321" aria-hidden="true" tabindex="-1"></a><span class="co"># Note we add the parent hash here!</span></span>
<span id="cb30-322"><a href="#cb30-322" aria-hidden="true" tabindex="-1"></a>hash2 <span class="op">=</span> sha1(data2 <span class="op">+</span> meta2 <span class="op">+</span> hash1.encode()).hexdigest()</span>
<span id="cb30-323"><a href="#cb30-323" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Hash:'</span>, hash2)</span>
<span id="cb30-324"><a href="#cb30-324" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-325"><a href="#cb30-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-326"><a href="#cb30-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-327"><a href="#cb30-327" aria-hidden="true" tabindex="-1"></a><span class="fu">### A repository</span></span>
<span id="cb30-328"><a href="#cb30-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-329"><a href="#cb30-329" aria-hidden="true" tabindex="-1"></a>A *repository* is the set of files for a project with their history. It's a collection of commits in the form of an directed acyclic graph.</span>
<span id="cb30-330"><a href="#cb30-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-331"><a href="#cb30-331" aria-hidden="true" tabindex="-1"></a>!<span class="co">[</span><span class="ot">Figure: A (simple) Git repository (Credit: ProGit book, CC License)</span><span class="co">]</span>(tree.png "visualization of a git repository (directed acyclic graph of commits)")</span>
<span id="cb30-332"><a href="#cb30-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-333"><a href="#cb30-333" aria-hidden="true" tabindex="-1"></a>Some other terms:</span>
<span id="cb30-334"><a href="#cb30-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-335"><a href="#cb30-335" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>*HEAD*: a pointer to the current commit</span>
<span id="cb30-336"><a href="#cb30-336" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>*tag*: a label for a commit</span>
<span id="cb30-337"><a href="#cb30-337" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>*branch*: a commit - often indicating a commit that has "branched" off of some main workflow or some linear sequence of commits</span>
<span id="cb30-338"><a href="#cb30-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-339"><a href="#cb30-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-340"><a href="#cb30-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-341"><a href="#cb30-341" aria-hidden="true" tabindex="-1"></a><span class="fu">### Staging area / index</span></span>
<span id="cb30-342"><a href="#cb30-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-343"><a href="#cb30-343" aria-hidden="true" tabindex="-1"></a>The index (staging area) keeps track of changes (made to tracked files) that are added, but that are not yet committed.</span>
<span id="cb30-344"><a href="#cb30-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-345"><a href="#cb30-345" aria-hidden="true" tabindex="-1"></a>Here's a high-level overview of how the staging area relates to the other pieces of what we've been doing.</span>
<span id="cb30-346"><a href="#cb30-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-347"><a href="#cb30-347" aria-hidden="true" tabindex="-1"></a><span class="al">![Figure: Local operations in a repository (Credit: ProGit book, CC License)](staging.png "Visualization of local operations in Git")</span></span>
<span id="cb30-348"><a href="#cb30-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-349"><a href="#cb30-349" aria-hidden="true" tabindex="-1"></a>And here's a more-detailed visualization of how various Git commands relate to your current directory, the staging area and the repository.</span>
<span id="cb30-350"><a href="#cb30-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-351"><a href="#cb30-351" aria-hidden="true" tabindex="-1"></a><span class="al">![Figure: detailed operations in a repository (Credit: Research Software Engineering with Python, CC License)](git-remote.png "Visualization of operations with and parts of Git")</span></span>
<span id="cb30-352"><a href="#cb30-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-353"><a href="#cb30-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-354"><a href="#cb30-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-355"><a href="#cb30-355" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip}</span>
<span id="cb30-356"><a href="#cb30-356" aria-hidden="true" tabindex="-1"></a><span class="fu">## Rolling back changes (optional)</span></span>
<span id="cb30-357"><a href="#cb30-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-358"><a href="#cb30-358" aria-hidden="true" tabindex="-1"></a>Once we have a conceptual understanding, then the commands used to undo or modify changes we've made are easier to understand, though often one has to look up the particular specific commands.</span>
<span id="cb30-359"><a href="#cb30-359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-360"><a href="#cb30-360" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb30-361"><a href="#cb30-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-362"><a href="#cb30-362" aria-hidden="true" tabindex="-1"></a><span class="fu">## Uncommitted changes</span></span>
<span id="cb30-363"><a href="#cb30-363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-364"><a href="#cb30-364" aria-hidden="true" tabindex="-1"></a>If I make some changes to a file that I decide are a mistake, before <span class="in">`git add`</span> (i.e., before registering/staging the changes with <span class="in">`git`</span>), I can always still edit the file to undo the mistakes.</span>
<span id="cb30-365"><a href="#cb30-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-366"><a href="#cb30-366" aria-hidden="true" tabindex="-1"></a>But I can also go back to the version stored by Git.</span>
<span id="cb30-367"><a href="#cb30-367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-368"><a href="#cb30-368" aria-hidden="true" tabindex="-1"></a><span class="in">```bash</span></span>
<span id="cb30-369"><a href="#cb30-369" aria-hidden="true" tabindex="-1"></a><span class="co"># Current, recommended syntax:</span></span>
<span id="cb30-370"><a href="#cb30-370" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> restore file.txt</span>
<span id="cb30-371"><a href="#cb30-371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-372"><a href="#cb30-372" aria-hidden="true" tabindex="-1"></a><span class="co"># Alternative (older) syntax:</span></span>
<span id="cb30-373"><a href="#cb30-373" aria-hidden="true" tabindex="-1"></a><span class="co"># git checkout -- file.txt  </span></span>
<span id="cb30-374"><a href="#cb30-374" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-375"><a href="#cb30-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-376"><a href="#cb30-376" aria-hidden="true" tabindex="-1"></a><span class="fu">## Staged, uncommitted changes</span></span>
<span id="cb30-377"><a href="#cb30-377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-378"><a href="#cb30-378" aria-hidden="true" tabindex="-1"></a>If we've added (staged) files via <span class="in">`git add`</span> but have not yet committed them,</span>
<span id="cb30-379"><a href="#cb30-379" aria-hidden="true" tabindex="-1"></a>the files are in the index (staging area). We can get those changes out</span>
<span id="cb30-380"><a href="#cb30-380" aria-hidden="true" tabindex="-1"></a>of the staging area like this:</span>
<span id="cb30-381"><a href="#cb30-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-382"><a href="#cb30-382" aria-hidden="true" tabindex="-1"></a><span class="in">```bash</span></span>
<span id="cb30-383"><a href="#cb30-383" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> status</span>
<span id="cb30-384"><a href="#cb30-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-385"><a href="#cb30-385" aria-hidden="true" tabindex="-1"></a><span class="co"># Current, recommended syntax:</span></span>
<span id="cb30-386"><a href="#cb30-386" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> restore <span class="at">--staged</span> file.txt</span>
<span id="cb30-387"><a href="#cb30-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-388"><a href="#cb30-388" aria-hidden="true" tabindex="-1"></a><span class="co"># Alternative (older) syntax:</span></span>
<span id="cb30-389"><a href="#cb30-389" aria-hidden="true" tabindex="-1"></a><span class="co"># git reset HEAD file.txt  # This is older syntax.</span></span>
<span id="cb30-390"><a href="#cb30-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-391"><a href="#cb30-391" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> status</span>
<span id="cb30-392"><a href="#cb30-392" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-393"><a href="#cb30-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-394"><a href="#cb30-394" aria-hidden="true" tabindex="-1"></a>Note that the changes still exist in <span class="in">`file.txt`</span> but they're no longer registered/staged with Git.</span>
<span id="cb30-395"><a href="#cb30-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-396"><a href="#cb30-396" aria-hidden="true" tabindex="-1"></a><span class="fu">## Committed changes</span></span>
<span id="cb30-397"><a href="#cb30-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-398"><a href="#cb30-398" aria-hidden="true" tabindex="-1"></a>Suppose you need to add or modify to your commit. This illustrates a few things you might do to update your commit.</span>
<span id="cb30-399"><a href="#cb30-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-400"><a href="#cb30-400" aria-hidden="true" tabindex="-1"></a><span class="in">```bash</span></span>
<span id="cb30-401"><a href="#cb30-401" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> commit <span class="at">-m</span> <span class="st">'Some commit'</span></span>
<span id="cb30-402"><a href="#cb30-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-403"><a href="#cb30-403" aria-hidden="true" tabindex="-1"></a><span class="co">## 1. Perhaps you forgot to include a new file.</span></span>
<span id="cb30-404"><a href="#cb30-404" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> add forgotten_file.txt</span>
<span id="cb30-405"><a href="#cb30-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-406"><a href="#cb30-406" aria-hidden="true" tabindex="-1"></a><span class="co">## 2. Perhaps you forgot to edit an existing file.</span></span>
<span id="cb30-407"><a href="#cb30-407" aria-hidden="true" tabindex="-1"></a><span class="co"># Edit file.txt.</span></span>
<span id="cb30-408"><a href="#cb30-408" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> add file.txt</span>
<span id="cb30-409"><a href="#cb30-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-410"><a href="#cb30-410" aria-hidden="true" tabindex="-1"></a><span class="co">## 3. Perhaps you need to get a version of a file from before.</span></span>
<span id="cb30-411"><a href="#cb30-411" aria-hidden="true" tabindex="-1"></a><span class="co"># Get version of file from previous commit.</span></span>
<span id="cb30-412"><a href="#cb30-412" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> checkout <span class="op">&lt;</span>commit_hash<span class="op">&gt;</span> file.txt</span>
<span id="cb30-413"><a href="#cb30-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-414"><a href="#cb30-414" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> commit <span class="at">--amend</span></span>
<span id="cb30-415"><a href="#cb30-415" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-416"><a href="#cb30-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-417"><a href="#cb30-417" aria-hidden="true" tabindex="-1"></a>Alternatively suppose you want to undo a commit:</span>
<span id="cb30-418"><a href="#cb30-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-419"><a href="#cb30-419" aria-hidden="true" tabindex="-1"></a><span class="in">```bash</span></span>
<span id="cb30-420"><a href="#cb30-420" aria-hidden="true" tabindex="-1"></a><span class="co">## To go back to the previous commit, but leave the changes in the working directory.</span></span>
<span id="cb30-421"><a href="#cb30-421" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> reset HEAD~1</span>
<span id="cb30-422"><a href="#cb30-422" aria-hidden="true" tabindex="-1"></a><span class="co">## To go back to a specific commit.</span></span>
<span id="cb30-423"><a href="#cb30-423" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> reset <span class="op">&lt;</span>commit_hash<span class="op">&gt;</span></span>
<span id="cb30-424"><a href="#cb30-424" aria-hidden="true" tabindex="-1"></a><span class="co">## To go back to a previous commit and remove any changes in the working directory.</span></span>
<span id="cb30-425"><a href="#cb30-425" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> reset <span class="at">--hard</span> <span class="op">&lt;</span>commit_hash<span class="op">&gt;</span></span>
<span id="cb30-426"><a href="#cb30-426" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-427"><a href="#cb30-427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-428"><a href="#cb30-428" aria-hidden="true" tabindex="-1"></a><span class="fu">## Pushed changes</span></span>
<span id="cb30-429"><a href="#cb30-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-430"><a href="#cb30-430" aria-hidden="true" tabindex="-1"></a><span class="in">```bash</span></span>
<span id="cb30-431"><a href="#cb30-431" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> revert <span class="op">&lt;</span>commit_hash<span class="op">&gt;</span></span>
<span id="cb30-432"><a href="#cb30-432" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> push</span>
<span id="cb30-433"><a href="#cb30-433" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-434"><a href="#cb30-434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-435"><a href="#cb30-435" aria-hidden="true" tabindex="-1"></a>Note that this creates a new commit that undoes the changes you don't want. So the undoing shows up in the history.</span>
<span id="cb30-436"><a href="#cb30-436" aria-hidden="true" tabindex="-1"></a>This is the safest option.</span>
<span id="cb30-437"><a href="#cb30-437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-438"><a href="#cb30-438" aria-hidden="true" tabindex="-1"></a>If you're *sure* no one else has pulled your changes from the remote:</span>
<span id="cb30-439"><a href="#cb30-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-440"><a href="#cb30-440" aria-hidden="true" tabindex="-1"></a><span class="in">```bash</span></span>
<span id="cb30-441"><a href="#cb30-441" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> reset <span class="op">&lt;</span>commit_hash<span class="op">&gt;</span></span>
<span id="cb30-442"><a href="#cb30-442" aria-hidden="true" tabindex="-1"></a><span class="co"># Make changes</span></span>
<span id="cb30-443"><a href="#cb30-443" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> commit <span class="at">-a</span> <span class="at">-m</span><span class="st">'Rework the mistake.'</span></span>
<span id="cb30-444"><a href="#cb30-444" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> push <span class="at">-f</span> origin <span class="op">&lt;</span>branch_name<span class="op">&gt;</span></span>
<span id="cb30-445"><a href="#cb30-445" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-446"><a href="#cb30-446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-447"><a href="#cb30-447" aria-hidden="true" tabindex="-1"></a>This will remove the previous commit at the remote (GitHub in our case). </span>
<span id="cb30-448"><a href="#cb30-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-449"><a href="#cb30-449" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb30-450"><a href="#cb30-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-451"><a href="#cb30-451" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb30-452"><a href="#cb30-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-453"><a href="#cb30-453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-454"><a href="#cb30-454" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exercise: code review (with a partner)</span></span>
<span id="cb30-455"><a href="#cb30-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-456"><a href="#cb30-456" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Step 0: Push your changes to GitHub</span></span>
<span id="cb30-457"><a href="#cb30-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-458"><a href="#cb30-458" aria-hidden="true" tabindex="-1"></a>This will make them easily available to your partner and mimics the process we want/need to use anyway when interacting with remote collaborators or working asynchronously. Do your collaboration on GitHub, which is designed to help with collaboration, and not via email/text/etc.</span>
<span id="cb30-459"><a href="#cb30-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-460"><a href="#cb30-460" aria-hidden="true" tabindex="-1"></a><span class="in">```bash</span></span>
<span id="cb30-461"><a href="#cb30-461" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> push</span>
<span id="cb30-462"><a href="#cb30-462" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-463"><a href="#cb30-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-464"><a href="#cb30-464" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Step 1: Make suggestions</span></span>
<span id="cb30-465"><a href="#cb30-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-466"><a href="#cb30-466" aria-hidden="true" tabindex="-1"></a>Go to your partner's repository at <span class="in">`https://github.com/&lt;user_name&gt;/newton-practice`</span>.</span>
<span id="cb30-467"><a href="#cb30-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-468"><a href="#cb30-468" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Look over their code.</span>
<span id="cb30-469"><a href="#cb30-469" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Make some comments/suggestions in a new GitHub issue (go to the <span class="in">`Issues`</span> button and click on <span class="in">`New issue`</span>).</span>
<span id="cb30-470"><a href="#cb30-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-471"><a href="#cb30-471" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Step 2: Respond to suggestions</span></span>
<span id="cb30-472"><a href="#cb30-472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-473"><a href="#cb30-473" aria-hidden="true" tabindex="-1"></a>In response to your partner's comments, make some small change(s) to your <span class="in">`newton.py`</span> code.</span>
<span id="cb30-474"><a href="#cb30-474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-475"><a href="#cb30-475" aria-hidden="true" tabindex="-1"></a>You can do this in DataHub (or locally on your laptop if that's what you're doing) and make a commit as we did in the previous exercise.</span>
<span id="cb30-476"><a href="#cb30-476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-477"><a href="#cb30-477" aria-hidden="true" tabindex="-1"></a>Or you can do the editing in your GitHub browser window by clicking on the file and choosing the pencil icon (far right) to edit it. When you save it, a commit will be made. Make sure to provide a commit message. You can also create new files via the <span class="in">`+`</span> button in the top of the left sidebar. If you make changes directly on GitHub, you'll also want to run <span class="in">`git pull`</span> to pull down the changes to your local repository on DataHub.</span>
<span id="cb30-478"><a href="#cb30-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-479"><a href="#cb30-479" aria-hidden="true" tabindex="-1"></a><span class="fu"># 4. Code style and documentation</span></span>
<span id="cb30-480"><a href="#cb30-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-481"><a href="#cb30-481" aria-hidden="true" tabindex="-1"></a>Having a (reasonably) consistent and clean style, plus documentation, is important for being able to</span>
<span id="cb30-482"><a href="#cb30-482" aria-hidden="true" tabindex="-1"></a>read and maintain your code.</span>
<span id="cb30-483"><a href="#cb30-483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-484"><a href="#cb30-484" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip collapse="true"}</span>
<span id="cb30-485"><a href="#cb30-485" aria-hidden="true" tabindex="-1"></a><span class="fu">## Q: Who is the person most likely to use your code again?</span></span>
<span id="cb30-486"><a href="#cb30-486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-487"><a href="#cb30-487" aria-hidden="true" tabindex="-1"></a>A: You, but at some point in the future by which you will have forgotten what the code does and why.</span>
<span id="cb30-488"><a href="#cb30-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-489"><a href="#cb30-489" aria-hidden="true" tabindex="-1"></a>I can't tell you how many times I've looked back at my</span>
<span id="cb30-490"><a href="#cb30-490" aria-hidden="true" tabindex="-1"></a>own code and been amazed at how little I remember and frustrated with the former self who wrote it.</span>
<span id="cb30-491"><a href="#cb30-491" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb30-492"><a href="#cb30-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-493"><a href="#cb30-493" aria-hidden="true" tabindex="-1"></a>A go-to reference on Python code style is the <span class="co">[</span><span class="ot">PEP8 style guide</span><span class="co">](https://peps.python.org/pep-0008)</span>. That said, it's extensive, quite detailed, and hard to absorb quickly.</span>
<span id="cb30-494"><a href="#cb30-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-495"><a href="#cb30-495" aria-hidden="true" tabindex="-1"></a>Here are a few key suggestions:</span>
<span id="cb30-496"><a href="#cb30-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-497"><a href="#cb30-497" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Indentation:</span>
<span id="cb30-498"><a href="#cb30-498" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Python is strict about indentation of course.</span>
<span id="cb30-499"><a href="#cb30-499" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Use 4 spaces per indentation level (avoid tabs if possible).</span>
<span id="cb30-500"><a href="#cb30-500" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Whitespace: use it in a variety of places. Some places where it is good to have it</span>
<span id="cb30-501"><a href="#cb30-501" aria-hidden="true" tabindex="-1"></a>    are</span>
<span id="cb30-502"><a href="#cb30-502" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>around operators (assignment and arithmetic), e.g., <span class="in">`x = x * 3`</span>;</span>
<span id="cb30-503"><a href="#cb30-503" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>between function arguments, e.g., <span class="in">`myfun(x, 3, data)`</span>;</span>
<span id="cb30-504"><a href="#cb30-504" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>between list/tuple elements, e.g., <span class="in">`x = [3, 5, 7]`</span>; and</span>
<span id="cb30-505"><a href="#cb30-505" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>between matrix/array indices, e.g., <span class="in">`x[3, :4]`</span>.</span>
<span id="cb30-506"><a href="#cb30-506" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Use blank lines to separate blocks of code with comments to say what</span>
<span id="cb30-507"><a href="#cb30-507" aria-hidden="true" tabindex="-1"></a>    the block does.</span>
<span id="cb30-508"><a href="#cb30-508" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Use whitespaces or parentheses for clarity even if not needed for order of</span>
<span id="cb30-509"><a href="#cb30-509" aria-hidden="true" tabindex="-1"></a>    operations. For example, <span class="in">`a/y*x`</span> will work but is not easy to read</span>
<span id="cb30-510"><a href="#cb30-510" aria-hidden="true" tabindex="-1"></a>    and you can easily induce a bug if you forget the order of ops. Instead,</span>
<span id="cb30-511"><a href="#cb30-511" aria-hidden="true" tabindex="-1"></a>    use <span class="in">`a/y * x`</span> or <span class="in">`(a/y) * x`</span>.</span>
<span id="cb30-512"><a href="#cb30-512" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Avoid code lines longer than 79 characters and comment/docstring lines</span>
<span id="cb30-513"><a href="#cb30-513" aria-hidden="true" tabindex="-1"></a>    longer than 72 characters.</span>
<span id="cb30-514"><a href="#cb30-514" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Comments:</span>
<span id="cb30-515"><a href="#cb30-515" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Add comments to explain *why*, not *how*.</span>
<span id="cb30-516"><a href="#cb30-516" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Don't restate the obvious; avoid things like <span class="in">`x = x + 1  # Increment x.`</span>.</span>
<span id="cb30-517"><a href="#cb30-517" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Some key things to document:</span>
<span id="cb30-518"><a href="#cb30-518" aria-hidden="true" tabindex="-1"></a><span class="ss">      - </span>summarizing a block of code,</span>
<span id="cb30-519"><a href="#cb30-519" aria-hidden="true" tabindex="-1"></a><span class="ss">      - </span>explaining a complicated piece of code or particular construction, and</span>
<span id="cb30-520"><a href="#cb30-520" aria-hidden="true" tabindex="-1"></a><span class="ss">      - </span>explaining non-obvious values or steps, such as <span class="in">`x = x + 1 # Compensate for image border.`</span></span>
<span id="cb30-521"><a href="#cb30-521" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Comments should generally be complete sentences.</span>
<span id="cb30-522"><a href="#cb30-522" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>You can use parentheses to group operations such that they can be split up into lines</span>
<span id="cb30-523"><a href="#cb30-523" aria-hidden="true" tabindex="-1"></a>  and easily commented, e.g.,</span>
<span id="cb30-524"><a href="#cb30-524" aria-hidden="true" tabindex="-1"></a>  <span class="in">```{python}</span></span>
<span id="cb30-525"><a href="#cb30-525" aria-hidden="true" tabindex="-1"></a>  <span class="co">#| eval: false</span></span>
<span id="cb30-526"><a href="#cb30-526" aria-hidden="true" tabindex="-1"></a>  newdf <span class="op">=</span> (</span>
<span id="cb30-527"><a href="#cb30-527" aria-hidden="true" tabindex="-1"></a>          pd.read_csv(<span class="st">'file.csv'</span>)                   <span class="co"># 1988 census data.</span></span>
<span id="cb30-528"><a href="#cb30-528" aria-hidden="true" tabindex="-1"></a>          .rename(columns <span class="op">=</span> {<span class="st">'STATE'</span>: <span class="st">'us_state'</span>})  <span class="co"># Adjust column names.</span></span>
<span id="cb30-529"><a href="#cb30-529" aria-hidden="true" tabindex="-1"></a>          .dropna()                                 <span class="co"># Remove rows with missing values.</span></span>
<span id="cb30-530"><a href="#cb30-530" aria-hidden="true" tabindex="-1"></a>          )</span>
<span id="cb30-531"><a href="#cb30-531" aria-hidden="true" tabindex="-1"></a>  <span class="in">```</span></span>
<span id="cb30-532"><a href="#cb30-532" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Being consistent about the naming style for objects and functions is hard, but try to be consistent. PEP8 suggests:</span>
<span id="cb30-533"><a href="#cb30-533" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Class names should be UpperCamelCase.</span>
<span id="cb30-534"><a href="#cb30-534" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Function, method, and variable names should be snake_case, e.g., <span class="in">`number_of_its`</span> or <span class="in">`n_its`</span>.</span>
<span id="cb30-535"><a href="#cb30-535" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Non-public methods and variables should have a leading underscore.</span>
<span id="cb30-536"><a href="#cb30-536" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Try to have the names be informative without being overly long.</span>
<span id="cb30-537"><a href="#cb30-537" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Don't overwrite names of objects/functions that already exist in the language. E.g., don't use <span class="in">`len`</span> in Python. That said, the namespace system helps with the unavoidable cases where there are name conflicts.</span>
<span id="cb30-538"><a href="#cb30-538" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Use active names for functions (e.g., <span class="in">`calc_loglik`</span>, <span class="in">`calc_log_lik`</span></span>
<span id="cb30-539"><a href="#cb30-539" aria-hidden="true" tabindex="-1"></a>    rather than <span class="in">`loglik`</span> or <span class="in">`loglik_calc`</span>). Functions are like to verbs in human language.</span>
<span id="cb30-540"><a href="#cb30-540" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Learn from others' code.</span>
<span id="cb30-541"><a href="#cb30-541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-542"><a href="#cb30-542" aria-hidden="true" tabindex="-1"></a><span class="fu">## Linting</span></span>
<span id="cb30-543"><a href="#cb30-543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-544"><a href="#cb30-544" aria-hidden="true" tabindex="-1"></a>Linting is the process of applying a tool to your code to enforce style.</span>
<span id="cb30-545"><a href="#cb30-545" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-546"><a href="#cb30-546" aria-hidden="true" tabindex="-1"></a>We'll demo using <span class="in">`ruff`</span> to some example code. You might also consider <span class="in">`black`</span>.</span>
<span id="cb30-547"><a href="#cb30-547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-548"><a href="#cb30-548" aria-hidden="true" tabindex="-1"></a>We'll practice with <span class="in">`ruff`</span> with a small module we'll use next also for debugging.</span>
<span id="cb30-549"><a href="#cb30-549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-550"><a href="#cb30-550" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>First, we check for and fix syntax errors.</span>
<span id="cb30-551"><a href="#cb30-551" aria-hidden="true" tabindex="-1"></a>  <span class="in">```bash</span></span>
<span id="cb30-552"><a href="#cb30-552" aria-hidden="true" tabindex="-1"></a>  <span class="ex">ruff</span> check newton.py</span>
<span id="cb30-553"><a href="#cb30-553" aria-hidden="true" tabindex="-1"></a>  <span class="in">```</span></span>
<span id="cb30-554"><a href="#cb30-554" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Then we ask <span class="in">`ruff`</span> to reformat to conform to standard style.</span>
<span id="cb30-555"><a href="#cb30-555" aria-hidden="true" tabindex="-1"></a>  <span class="in">```bash</span></span>
<span id="cb30-556"><a href="#cb30-556" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cp</span> newton.py newton-save.py   <span class="co"># So we can see what `ruff` did.</span></span>
<span id="cb30-557"><a href="#cb30-557" aria-hidden="true" tabindex="-1"></a>  <span class="ex">ruff</span> format newton.py</span>
<span id="cb30-558"><a href="#cb30-558" aria-hidden="true" tabindex="-1"></a>  <span class="in">```</span></span>
<span id="cb30-559"><a href="#cb30-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-560"><a href="#cb30-560" aria-hidden="true" tabindex="-1"></a>Let's see what changed:</span>
<span id="cb30-561"><a href="#cb30-561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-562"><a href="#cb30-562" aria-hidden="true" tabindex="-1"></a><span class="in">```bash</span></span>
<span id="cb30-563"><a href="#cb30-563" aria-hidden="true" tabindex="-1"></a><span class="fu">diff</span> newton-save.py newton.py</span>
<span id="cb30-564"><a href="#cb30-564" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-565"><a href="#cb30-565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-566"><a href="#cb30-566" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exercise: add documentation and comments to your Newton module</span></span>
<span id="cb30-567"><a href="#cb30-567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-568"><a href="#cb30-568" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Add a <span class="co">[</span><span class="ot">doc string</span><span class="co">](https://peps.python.org/pep-0257)</span> to each of your functions. Focus on your main function. Take a look at an example, such as <span class="in">`help(numpy.linalg.cholesky)`</span> to see the different parts and the format. Docstrings are also a good thing to ask an AI coding tool to help with.</span>
<span id="cb30-569"><a href="#cb30-569" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Consider whether to add comments to your code.</span>
<span id="cb30-570"><a href="#cb30-570" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Apply <span class="in">`ruff`</span> to your code.</span>
<span id="cb30-571"><a href="#cb30-571" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>Compare the results with the style suggestions above and do additional reformatting as needed.</span>
<span id="cb30-572"><a href="#cb30-572" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>Commit and push to GitHub. Remember to have a good commit message!</span>
<span id="cb30-573"><a href="#cb30-573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-574"><a href="#cb30-574" aria-hidden="true" tabindex="-1"></a><span class="fu"># 5. Debugging</span></span>
<span id="cb30-575"><a href="#cb30-575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-576"><a href="#cb30-576" aria-hidden="true" tabindex="-1"></a>Once you start writing more complicated code, even in an interpreted language such as Python that you can run line-by-line, you'll want to use a debugger, particularly when you have nested function calls.</span>
<span id="cb30-577"><a href="#cb30-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-578"><a href="#cb30-578" aria-hidden="true" tabindex="-1"></a>Debugging can be a slow process, so you typically start a debugging session by deciding which line in your code you would like to start tracing the behavior from, and you place a *breakpoint*. Then you can have the debugger run the program up to that point and stop at it, allowing you to:</span>
<span id="cb30-579"><a href="#cb30-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-580"><a href="#cb30-580" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>inspect the current state of variables,</span>
<span id="cb30-581"><a href="#cb30-581" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>step through the code line by line,</span>
<span id="cb30-582"><a href="#cb30-582" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>step over or into functions as they are called, and</span>
<span id="cb30-583"><a href="#cb30-583" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>resume program execution.</span>
<span id="cb30-584"><a href="#cb30-584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-585"><a href="#cb30-585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-586"><a href="#cb30-586" aria-hidden="true" tabindex="-1"></a>The *stack* is the series of nested function calls. When an error occurs, Python will print the *stack trace* showing the sequence of calls leading to the error. This can be helpful and distracting/confusing.</span>
<span id="cb30-587"><a href="#cb30-587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-588"><a href="#cb30-588" aria-hidden="true" tabindex="-1"></a>We'll use the debugger in JupyterLab; similar functionality is in VS Code. And you can use <span class="in">`pdb`</span> directly from the command line; the ideas are all the same.</span>
<span id="cb30-589"><a href="#cb30-589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-590"><a href="#cb30-590" aria-hidden="true" tabindex="-1"></a><span class="fu">## Demo: debugging my Newton implementation</span></span>
<span id="cb30-591"><a href="#cb30-591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-592"><a href="#cb30-592" aria-hidden="true" tabindex="-1"></a><span class="fu">### Using the JupyterLab visual debugger</span></span>
<span id="cb30-593"><a href="#cb30-593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-594"><a href="#cb30-594" aria-hidden="true" tabindex="-1"></a>Let's debug my buggy implementation of Newton's method.</span>
<span id="cb30-595"><a href="#cb30-595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-598"><a href="#cb30-598" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb30-599"><a href="#cb30-599" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb30-600"><a href="#cb30-600" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> newton</span>
<span id="cb30-601"><a href="#cb30-601" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb30-602"><a href="#cb30-602" aria-hidden="true" tabindex="-1"></a>newton.optimize(<span class="fl">2.95</span>, np.cos)</span>
<span id="cb30-603"><a href="#cb30-603" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-604"><a href="#cb30-604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-605"><a href="#cb30-605" aria-hidden="true" tabindex="-1"></a>Clearly that doesn't work. Let's debug it.</span>
<span id="cb30-606"><a href="#cb30-606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-607"><a href="#cb30-607" aria-hidden="true" tabindex="-1"></a>We'll work in our Jupyter notebook.</span>
<span id="cb30-608"><a href="#cb30-608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-609"><a href="#cb30-609" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>First turn on debugging capability by clicking on the small "bug" icon of the top navigation bar under the file tabs and to the left of the  info about the kernel.</span>
<span id="cb30-610"><a href="#cb30-610" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Next we click on a line of code to set a breakpoint.</span>
<span id="cb30-611"><a href="#cb30-611" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Now we run the function by executing the cell containing the function call. Using the icons in the <span class="in">`Callstack`</span> pane, we can:</span>
<span id="cb30-612"><a href="#cb30-612" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>continue (to the end or the next breakpoint),</span>
<span id="cb30-613"><a href="#cb30-613" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>finish,</span>
<span id="cb30-614"><a href="#cb30-614" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>run the next line,</span>
<span id="cb30-615"><a href="#cb30-615" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>step (in/down) into a nested function</span>
<span id="cb30-616"><a href="#cb30-616" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>step (out/up) out of a function, or</span>
<span id="cb30-617"><a href="#cb30-617" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>evaluate an expression</span>
<span id="cb30-618"><a href="#cb30-618" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>the output may show up in the notebook, but one can also click on the "log" icon at the bottom and set the "Log Level" to "debug" to see the output in a separate logging pane at the bottom.</span>
<span id="cb30-619"><a href="#cb30-619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-620"><a href="#cb30-620" aria-hidden="true" tabindex="-1"></a>Here are screenshots showing the steps/components of the visual debugger:</span>
<span id="cb30-621"><a href="#cb30-621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-622"><a href="#cb30-622" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb30-623"><a href="#cb30-623" aria-hidden="true" tabindex="-1"></a><span class="fu">## Access debugger</span></span>
<span id="cb30-624"><a href="#cb30-624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-625"><a href="#cb30-625" aria-hidden="true" tabindex="-1"></a><span class="al">![](shot1a.pdf "Access the debugger")</span>{width=800 height=600}</span>
<span id="cb30-626"><a href="#cb30-626" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-627"><a href="#cb30-627" aria-hidden="true" tabindex="-1"></a><span class="fu">## Start execution</span></span>
<span id="cb30-628"><a href="#cb30-628" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-629"><a href="#cb30-629" aria-hidden="true" tabindex="-1"></a><span class="al">![](shot2a.pdf "Set a breakpoint and start execution")</span>{width=800 height=600}</span>
<span id="cb30-630"><a href="#cb30-630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-631"><a href="#cb30-631" aria-hidden="true" tabindex="-1"></a><span class="fu">## Step into code</span></span>
<span id="cb30-632"><a href="#cb30-632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-633"><a href="#cb30-633" aria-hidden="true" tabindex="-1"></a><span class="al">![](shot3a.pdf "Step into a function")</span>{width=800 height=600}</span>
<span id="cb30-634"><a href="#cb30-634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-635"><a href="#cb30-635" aria-hidden="true" tabindex="-1"></a><span class="fu">## Control execution</span></span>
<span id="cb30-636"><a href="#cb30-636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-637"><a href="#cb30-637" aria-hidden="true" tabindex="-1"></a><span class="al">![](shot4a.pdf "Control execution")</span>{width=800 height=600}</span>
<span id="cb30-638"><a href="#cb30-638" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-639"><a href="#cb30-639" aria-hidden="true" tabindex="-1"></a><span class="fu">## Evaluate code</span></span>
<span id="cb30-640"><a href="#cb30-640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-641"><a href="#cb30-641" aria-hidden="true" tabindex="-1"></a><span class="al">![](shot5a.pdf "Evaluate code in context")</span>{width=800 height=600}</span>
<span id="cb30-642"><a href="#cb30-642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-643"><a href="#cb30-643" aria-hidden="true" tabindex="-1"></a><span class="fu">## View result</span></span>
<span id="cb30-644"><a href="#cb30-644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-645"><a href="#cb30-645" aria-hidden="true" tabindex="-1"></a><span class="al">![](shot6a.pdf "View result of evaluation")</span>{width=800 height=600}</span>
<span id="cb30-646"><a href="#cb30-646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-647"><a href="#cb30-647" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb30-648"><a href="#cb30-648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-649"><a href="#cb30-649" aria-hidden="true" tabindex="-1"></a>If we want to debug into functions defined in files, we can add <span class="in">`breakpoint()`</span> in the location in the file where we want the breakpoint and one should see the code in the <span class="in">`SOURCE`</span> box in the debugger panel. So far, I've found this to be a bit hard to use, but that may well just be my inexperience with the JupyterLab debugger.</span>
<span id="cb30-650"><a href="#cb30-650" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-651"><a href="#cb30-651" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-652"><a href="#cb30-652" aria-hidden="true" tabindex="-1"></a>::: {.callout-warning}</span>
<span id="cb30-653"><a href="#cb30-653" aria-hidden="true" tabindex="-1"></a>Note that the value of <span class="in">`x_new`</span> doesn't show up automatically in the variables pane. This is probably because it is a numpy variable rather than a regular Python variable.</span>
<span id="cb30-654"><a href="#cb30-654" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb30-655"><a href="#cb30-655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-656"><a href="#cb30-656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-657"><a href="#cb30-657" aria-hidden="true" tabindex="-1"></a><span class="fu">### Using the IPython debugger (`ipdb`)</span></span>
<span id="cb30-658"><a href="#cb30-658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-659"><a href="#cb30-659" aria-hidden="true" tabindex="-1"></a>We can use the IPython <span class="in">`%debug`</span> "magic" to activate a debugger as well.</span>
<span id="cb30-660"><a href="#cb30-660" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-661"><a href="#cb30-661" aria-hidden="true" tabindex="-1"></a>One way this is particularly useful is "post-mortem" debugging, i.e., debugging when exceptions (errors) have occurred. We just invoke <span class="in">`%debug`</span> and then (re)run the code that is failing. The <span class="in">`ipdb`</span> debugger will be invoked when the error occurs.</span>
<span id="cb30-662"><a href="#cb30-662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-663"><a href="#cb30-663" aria-hidden="true" tabindex="-1"></a>Once in the ipdb debugger, we can use these commands (most of which correspond to icons we used to control the JupyterLab debugger behavior):</span>
<span id="cb30-664"><a href="#cb30-664" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-665"><a href="#cb30-665" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`c`</span> to continue execution (until the end or the next breakpoint)</span>
<span id="cb30-666"><a href="#cb30-666" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`n`</span> to run the next line of code</span>
<span id="cb30-667"><a href="#cb30-667" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`u`</span> and <span class="in">`d`</span> to step up and down through the stack of function calls</span>
<span id="cb30-668"><a href="#cb30-668" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`p expr`</span> to print the result of the <span class="in">`expr`</span> code</span>
<span id="cb30-669"><a href="#cb30-669" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`q`</span> to quit the debugger</span>
<span id="cb30-670"><a href="#cb30-670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-671"><a href="#cb30-671" aria-hidden="true" tabindex="-1"></a>We'll put a silly error into the code, restart the kernel, and use the post-mortem debugging approach as an illustration.</span>
<span id="cb30-672"><a href="#cb30-672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-673"><a href="#cb30-673" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exercise: debugging your Newton code</span></span>
<span id="cb30-674"><a href="#cb30-674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-675"><a href="#cb30-675" aria-hidden="true" tabindex="-1"></a>Run your Newton method on the following function, $x^4/4 - x^3 -x$, for various starting values.</span>
<span id="cb30-676"><a href="#cb30-676" aria-hidden="true" tabindex="-1"></a>Sometimes it should fail.</span>
<span id="cb30-677"><a href="#cb30-677" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-678"><a href="#cb30-678" aria-hidden="true" tabindex="-1"></a>Use the debugger to try to see what goes wrong. (For our purposes here, do this using the debugger; don't figure it out from first principles mathematically or graphically.)</span>
<span id="cb30-679"><a href="#cb30-679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-680"><a href="#cb30-680" aria-hidden="true" tabindex="-1"></a>Conditional breakpoints are a useful tool that causes the debugger to stop at a breakpoint only if some condition is true (e.g., if some extreme value is reached in the Newton iterations). I don't see that it's possible to do this with the JupyterLab debugger, but with the <span class="in">`ipdb`</span> debugger you can do things like this to debug a particular line of a particular file if a condition (here <span class="in">`x==5`</span>) is met:</span>
<span id="cb30-681"><a href="#cb30-681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-682"><a href="#cb30-682" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-683"><a href="#cb30-683" aria-hidden="true" tabindex="-1"></a><span class="in">b path/to/script.py:999, x==5</span></span>
<span id="cb30-684"><a href="#cb30-684" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-685"><a href="#cb30-685" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-686"><a href="#cb30-686" aria-hidden="true" tabindex="-1"></a><span class="fu"># 6. Defensive programming, error checking and testing</span></span>
<span id="cb30-687"><a href="#cb30-687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-688"><a href="#cb30-688" aria-hidden="true" tabindex="-1"></a><span class="fu">## Demo: Unit tests and `pytest`</span></span>
<span id="cb30-689"><a href="#cb30-689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-690"><a href="#cb30-690" aria-hidden="true" tabindex="-1"></a><span class="in">`pytest`</span> is a very popular package/framework for testing. </span>
<span id="cb30-691"><a href="#cb30-691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-692"><a href="#cb30-692" aria-hidden="true" tabindex="-1"></a>We create test functions that check for the expected result.</span>
<span id="cb30-693"><a href="#cb30-693" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-694"><a href="#cb30-694" aria-hidden="true" tabindex="-1"></a>We use <span class="in">`assert`</span> statements. These are ways of generally setting up sanity checks in your code. They are usually used in development, or perhaps data analysis workflows, rather than production code. They are a core part of setting up tests such as here with <span class="in">`pytest`</span>.</span>
<span id="cb30-695"><a href="#cb30-695" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-696"><a href="#cb30-696" aria-hidden="true" tabindex="-1"></a><span class="in">```bash</span></span>
<span id="cb30-697"><a href="#cb30-697" aria-hidden="true" tabindex="-1"></a><span class="ex">pytest</span> test_newton.py</span>
<span id="cb30-698"><a href="#cb30-698" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-699"><a href="#cb30-699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-700"><a href="#cb30-700" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exercise: Test cases</span></span>
<span id="cb30-701"><a href="#cb30-701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-702"><a href="#cb30-702" aria-hidden="true" tabindex="-1"></a>With a partner, brainstorm some test cases for your implementation of Newton's method in terms of the user's function and input values a user might provide.</span>
<span id="cb30-703"><a href="#cb30-703" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-704"><a href="#cb30-704" aria-hidden="true" tabindex="-1"></a>In addition to cases where it should succeed, you'll want to consider cases where Newton's method fails and test whether the user gets an informative result. Of course as a starting point, the case we used for the debugging exercise is a good one for a failing case. </span>
<span id="cb30-705"><a href="#cb30-705" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-706"><a href="#cb30-706" aria-hidden="true" tabindex="-1"></a>We'll collect some possible tests once each group has had a chance to brainstorm.</span>
<span id="cb30-707"><a href="#cb30-707" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-708"><a href="#cb30-708" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exercise: Unit tests</span></span>
<span id="cb30-709"><a href="#cb30-709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-710"><a href="#cb30-710" aria-hidden="true" tabindex="-1"></a>Implement your test cases as unit tests using the <span class="in">`pytest`</span> package.</span>
<span id="cb30-711"><a href="#cb30-711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-712"><a href="#cb30-712" aria-hidden="true" tabindex="-1"></a>Include tests for:</span>
<span id="cb30-713"><a href="#cb30-713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-714"><a href="#cb30-714" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>successful optimization</span>
<span id="cb30-715"><a href="#cb30-715" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>unsuccessful optimization</span>
<span id="cb30-716"><a href="#cb30-716" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>invalid user inputs</span>
<span id="cb30-717"><a href="#cb30-717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-718"><a href="#cb30-718" aria-hidden="true" tabindex="-1"></a>with the expected output being what you *want* to happen, not necessarily what your function does.</span>
<span id="cb30-719"><a href="#cb30-719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-720"><a href="#cb30-720" aria-hidden="true" tabindex="-1"></a>You'll want cases where you know the correct answer. Start simple.</span>
<span id="cb30-721"><a href="#cb30-721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-722"><a href="#cb30-722" aria-hidden="true" tabindex="-1"></a>::: {.callout-caution}</span>
<span id="cb30-723"><a href="#cb30-723" aria-hidden="true" tabindex="-1"></a><span class="fu">## Only write tests now</span></span>
<span id="cb30-724"><a href="#cb30-724" aria-hidden="true" tabindex="-1"></a>For now don't modify your code even if you start to suspect how it might fail. Writing the tests and then modifying code so they pass is an example of *test-driven development*.</span>
<span id="cb30-725"><a href="#cb30-725" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb30-726"><a href="#cb30-726" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-727"><a href="#cb30-727" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exceptions in Python</span></span>
<span id="cb30-728"><a href="#cb30-728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-729"><a href="#cb30-729" aria-hidden="true" tabindex="-1"></a>To understand how Python handles error, you can take a look at the <span class="co">[</span><span class="ot">Errors and Exceptions section</span><span class="co">](https://swcarpentry.github.io/python-novice-inflammation/09-errors.html)</span>{target="_blank"} of the Software Carpentry workshop. The primary ideas covered are understanding error messages and tracebacks.</span>
<span id="cb30-730"><a href="#cb30-730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-731"><a href="#cb30-731" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exercise: Error trapping, robust code, and defensive programming</span></span>
<span id="cb30-732"><a href="#cb30-732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-733"><a href="#cb30-733" aria-hidden="true" tabindex="-1"></a>Now we'll try to go beyond simply returning a failed result and see if we can trap problems early on and write more robust code. </span>
<span id="cb30-734"><a href="#cb30-734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-735"><a href="#cb30-735" aria-hidden="true" tabindex="-1"></a>Work on the following improvements:</span>
<span id="cb30-736"><a href="#cb30-736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-737"><a href="#cb30-737" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Check user inputs are valid.</span>
<span id="cb30-738"><a href="#cb30-738" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Add warnings to the user if it seems that Newton's method is taking a bad step.</span>
<span id="cb30-739"><a href="#cb30-739" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Modify your function so that when it fails, the result is informative to the user.</span>
<span id="cb30-740"><a href="#cb30-740" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Include a success/failure code (flag) in your output.</span>
<span id="cb30-741"><a href="#cb30-741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-742"><a href="#cb30-742" aria-hidden="true" tabindex="-1"></a>Your code should handle errors using exceptions, as discussed earlier for Python itself. We don't have time to go fully into how Python handles the wide variety of exceptions. But here are a few basic things you can do to *raise* an *exception* (i.e., to report an error and stop execution):</span>
<span id="cb30-743"><a href="#cb30-743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-744"><a href="#cb30-744" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-745"><a href="#cb30-745" aria-hidden="true" tabindex="-1"></a><span class="in">if not callable(f):</span></span>
<span id="cb30-746"><a href="#cb30-746" aria-hidden="true" tabindex="-1"></a><span class="in">   raise TypeError(f"Argument is not a function, it is of type {type(f)}")</span></span>
<span id="cb30-747"><a href="#cb30-747" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-748"><a href="#cb30-748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-749"><a href="#cb30-749" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-750"><a href="#cb30-750" aria-hidden="true" tabindex="-1"></a><span class="in">if x &gt; 1e7:</span></span>
<span id="cb30-751"><a href="#cb30-751" aria-hidden="true" tabindex="-1"></a><span class="in">   raise RuntimeError(f"At iteration {iter}, optimization appears to be diverging")</span></span>
<span id="cb30-752"><a href="#cb30-752" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-753"><a href="#cb30-753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-754"><a href="#cb30-754" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-755"><a href="#cb30-755" aria-hidden="true" tabindex="-1"></a><span class="in">import warnings</span></span>
<span id="cb30-756"><a href="#cb30-756" aria-hidden="true" tabindex="-1"></a><span class="in">if x &gt; 3:</span></span>
<span id="cb30-757"><a href="#cb30-757" aria-hidden="true" tabindex="-1"></a><span class="in">   warnings.warn(f"{x} is greater than 3.", UserWarning)</span></span>
<span id="cb30-758"><a href="#cb30-758" aria-hidden="true" tabindex="-1"></a><span class="in">```</span>  </span>
<span id="cb30-759"><a href="#cb30-759" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-760"><a href="#cb30-760" aria-hidden="true" tabindex="-1"></a>Next, if you have time, consider robustifying your code:</span>
<span id="cb30-761"><a href="#cb30-761" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-762"><a href="#cb30-762" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>What might you do to modify what the algorithm does if the next step is worse than the current position?  </span>
<span id="cb30-763"><a href="#cb30-763" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>What might you do if the next step is outside the range of potential values (assuming a unimodal function)? </span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>